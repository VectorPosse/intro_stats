<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>17&nbsp; Chi-square goodness-of-fit test – Introduction to Statistics: an integrated textbook and workbook using R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./18-chi_square_test_for_independence-web.html" rel="next">
<link href="./16-inference_for_two_proportions-web.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c1f47e0d63438896ca427a756e834e96.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./17-chi_square_goodness_of_fit-web.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Chi-square goodness-of-fit test</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Statistics: an integrated textbook and workbook using R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/VectorPosse/intro_stats" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro_to_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-using_quarto-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Using Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-categorical_data-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Categorical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-numerical_data-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Numerical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-manipulating_data-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulating data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-correlation-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Correlation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-regression-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-intro_to_randomization_1-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to randomization, Part 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-intro_to_randomization_2-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to randomization, Part 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-hypothesis_testing_with_randomization_1-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hypothesis testing with randomization, Part 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-hypothesis_testing_with_randomization_2-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesis testing with randomization, Part 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-confidence_intervals-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Confidence intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-normal_models-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Normal models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-sampling_distribution_models-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Sampling distribution models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-inference_for_one_proportion-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Inference for one proportion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-inference_for_two_proportions-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Inference for two proportions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-chi_square_goodness_of_fit-web.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Chi-square goodness-of-fit test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-chi_square_test_for_independence-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Chi-square test for independence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19-inference_for_one_mean-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference for one mean</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Rubric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Rubric for inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Concordance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Concordance with <em>Introduction to Modern Statistics</em> (IMS)</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">17.1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#install-new-packages" id="toc-install-new-packages" class="nav-link" data-scroll-target="#install-new-packages"><span class="header-section-number">17.1.1</span> Install new packages</a></li>
  <li><a href="#download-the-quarto-file" id="toc-download-the-quarto-file" class="nav-link" data-scroll-target="#download-the-quarto-file"><span class="header-section-number">17.1.2</span> Download the Quarto file</a></li>
  <li><a href="#restart-r-and-run-all-chunks" id="toc-restart-r-and-run-all-chunks" class="nav-link" data-scroll-target="#restart-r-and-run-all-chunks"><span class="header-section-number">17.1.3</span> Restart R and run all chunks</a></li>
  </ul></li>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages"><span class="header-section-number">17.2</span> Load packages</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question"><span class="header-section-number">17.3</span> Research question</a></li>
  <li><a href="#chi-squared" id="toc-chi-squared" class="nav-link" data-scroll-target="#chi-squared"><span class="header-section-number">17.4</span> Chi-squared</a></li>
  <li><a href="#the-chi-square-distribution" id="toc-the-chi-square-distribution" class="nav-link" data-scroll-target="#the-chi-square-distribution"><span class="header-section-number">17.5</span> The chi-square distribution</a></li>
  <li><a href="#chi-square-as-a-sampling-distribution-model" id="toc-chi-square-as-a-sampling-distribution-model" class="nav-link" data-scroll-target="#chi-square-as-a-sampling-distribution-model"><span class="header-section-number">17.6</span> Chi-square as a sampling distribution model</a></li>
  <li><a href="#chi-square-goodness-of-fit-test" id="toc-chi-square-goodness-of-fit-test" class="nav-link" data-scroll-target="#chi-square-goodness-of-fit-test"><span class="header-section-number">17.7</span> Chi-square goodness-of-fit test</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="header-section-number">17.8</span> Exploratory data analysis</a>
  <ul class="collapse">
  <li><a href="#use-data-documentation-help-files-code-books-google-etc.-to-determine-as-much-as-possible-about-the-data-provenance-and-structure." id="toc-use-data-documentation-help-files-code-books-google-etc.-to-determine-as-much-as-possible-about-the-data-provenance-and-structure." class="nav-link" data-scroll-target="#use-data-documentation-help-files-code-books-google-etc.-to-determine-as-much-as-possible-about-the-data-provenance-and-structure."><span class="header-section-number">17.8.1</span> Use data documentation (help files, code books, Google, etc.) to determine as much as possible about the data provenance and structure.</a></li>
  <li><a href="#prepare-the-data-for-analysis." id="toc-prepare-the-data-for-analysis." class="nav-link" data-scroll-target="#prepare-the-data-for-analysis."><span class="header-section-number">17.8.2</span> Prepare the data for analysis.</a></li>
  <li><a href="#make-tables-or-plots-to-explore-the-data-visually." id="toc-make-tables-or-plots-to-explore-the-data-visually." class="nav-link" data-scroll-target="#make-tables-or-plots-to-explore-the-data-visually."><span class="header-section-number">17.8.3</span> Make tables or plots to explore the data visually.</a></li>
  </ul></li>
  <li><a href="#hypotheses" id="toc-hypotheses" class="nav-link" data-scroll-target="#hypotheses"><span class="header-section-number">17.9</span> Hypotheses</a>
  <ul class="collapse">
  <li><a href="#identify-the-sample-or-samples-and-a-reasonable-population-or-populations-of-interest." id="toc-identify-the-sample-or-samples-and-a-reasonable-population-or-populations-of-interest." class="nav-link" data-scroll-target="#identify-the-sample-or-samples-and-a-reasonable-population-or-populations-of-interest."><span class="header-section-number">17.9.1</span> Identify the sample (or samples) and a reasonable population (or populations) of interest.</a></li>
  <li><a href="#express-the-null-and-alternative-hypotheses-as-contextually-meaningful-full-sentences." id="toc-express-the-null-and-alternative-hypotheses-as-contextually-meaningful-full-sentences." class="nav-link" data-scroll-target="#express-the-null-and-alternative-hypotheses-as-contextually-meaningful-full-sentences."><span class="header-section-number">17.9.2</span> Express the null and alternative hypotheses as contextually meaningful full sentences.</a></li>
  <li><a href="#express-the-null-and-alternative-hypotheses-in-symbols-when-possible." id="toc-express-the-null-and-alternative-hypotheses-in-symbols-when-possible." class="nav-link" data-scroll-target="#express-the-null-and-alternative-hypotheses-in-symbols-when-possible."><span class="header-section-number">17.9.3</span> Express the null and alternative hypotheses in symbols (when possible).</a></li>
  </ul></li>
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model"><span class="header-section-number">17.10</span> Model</a>
  <ul class="collapse">
  <li><a href="#identify-the-sampling-distribution-model." id="toc-identify-the-sampling-distribution-model." class="nav-link" data-scroll-target="#identify-the-sampling-distribution-model."><span class="header-section-number">17.10.1</span> Identify the sampling distribution model.</a></li>
  <li><a href="#check-the-relevant-conditions-to-ensure-that-model-assumptions-are-met." id="toc-check-the-relevant-conditions-to-ensure-that-model-assumptions-are-met." class="nav-link" data-scroll-target="#check-the-relevant-conditions-to-ensure-that-model-assumptions-are-met."><span class="header-section-number">17.10.2</span> Check the relevant conditions to ensure that model assumptions are met.</a></li>
  </ul></li>
  <li><a href="#mechanics" id="toc-mechanics" class="nav-link" data-scroll-target="#mechanics"><span class="header-section-number">17.11</span> Mechanics</a>
  <ul class="collapse">
  <li><a href="#compute-the-test-statistic." id="toc-compute-the-test-statistic." class="nav-link" data-scroll-target="#compute-the-test-statistic."><span class="header-section-number">17.11.1</span> Compute the test statistic.</a></li>
  <li><a href="#report-the-test-statistic-in-context-when-possible." id="toc-report-the-test-statistic-in-context-when-possible." class="nav-link" data-scroll-target="#report-the-test-statistic-in-context-when-possible."><span class="header-section-number">17.11.2</span> Report the test statistic in context (when possible).</a></li>
  <li><a href="#plot-the-null-distribution." id="toc-plot-the-null-distribution." class="nav-link" data-scroll-target="#plot-the-null-distribution."><span class="header-section-number">17.11.3</span> Plot the null distribution.</a></li>
  <li><a href="#calculate-the-p-value." id="toc-calculate-the-p-value." class="nav-link" data-scroll-target="#calculate-the-p-value."><span class="header-section-number">17.11.4</span> Calculate the P-value.</a></li>
  <li><a href="#interpret-the-p-value-as-a-probability-given-the-null." id="toc-interpret-the-p-value-as-a-probability-given-the-null." class="nav-link" data-scroll-target="#interpret-the-p-value-as-a-probability-given-the-null."><span class="header-section-number">17.11.5</span> Interpret the P-value as a probability given the null.</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">17.12</span> Conclusion</a>
  <ul class="collapse">
  <li><a href="#state-the-statistical-conclusion." id="toc-state-the-statistical-conclusion." class="nav-link" data-scroll-target="#state-the-statistical-conclusion."><span class="header-section-number">17.12.1</span> State the statistical conclusion.</a></li>
  <li><a href="#state-but-do-not-overstate-a-contextually-meaningful-conclusion." id="toc-state-but-do-not-overstate-a-contextually-meaningful-conclusion." class="nav-link" data-scroll-target="#state-but-do-not-overstate-a-contextually-meaningful-conclusion."><span class="header-section-number">17.12.2</span> State (but do not overstate) a contextually meaningful conclusion.</a></li>
  <li><a href="#express-reservations-or-uncertainty-about-the-generalizability-of-the-conclusion." id="toc-express-reservations-or-uncertainty-about-the-generalizability-of-the-conclusion." class="nav-link" data-scroll-target="#express-reservations-or-uncertainty-about-the-generalizability-of-the-conclusion."><span class="header-section-number">17.12.3</span> Express reservations or uncertainty about the generalizability of the conclusion.</a></li>
  <li><a href="#identify-the-possibility-of-either-a-type-i-or-type-ii-error-and-state-what-making-such-an-error-means-in-the-context-of-the-hypotheses." id="toc-identify-the-possibility-of-either-a-type-i-or-type-ii-error-and-state-what-making-such-an-error-means-in-the-context-of-the-hypotheses." class="nav-link" data-scroll-target="#identify-the-possibility-of-either-a-type-i-or-type-ii-error-and-state-what-making-such-an-error-means-in-the-context-of-the-hypotheses."><span class="header-section-number">17.12.4</span> Identify the possibility of either a Type I or Type II error and state what making such an error means in the context of the hypotheses.</a></li>
  </ul></li>
  <li><a href="#confidence-interval" id="toc-confidence-interval" class="nav-link" data-scroll-target="#confidence-interval"><span class="header-section-number">17.13</span> Confidence interval</a></li>
  <li><a href="#your-turn" id="toc-your-turn" class="nav-link" data-scroll-target="#your-turn"><span class="header-section-number">17.14</span> Your turn</a></li>
  <li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals"><span class="header-section-number">17.15</span> Residuals</a></li>
  <li><a href="#your-turn-1" id="toc-your-turn-1" class="nav-link" data-scroll-target="#your-turn-1"><span class="header-section-number">17.16</span> Your turn</a></li>
  <li><a href="#conclusion-2" id="toc-conclusion-2" class="nav-link" data-scroll-target="#conclusion-2"><span class="header-section-number">17.17</span> Conclusion</a>
  <ul class="collapse">
  <li><a href="#preparing-and-submitting-your-assignment" id="toc-preparing-and-submitting-your-assignment" class="nav-link" data-scroll-target="#preparing-and-submitting-your-assignment"><span class="header-section-number">17.17.1</span> Preparing and submitting your assignment</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/VectorPosse/intro_stats/edit/main/17-chi_square_goodness_of_fit-web.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/VectorPosse/intro_stats/issues" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Chi-square goodness-of-fit test</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Functions introduced in this chapter:
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>chisq.test</code></p>
</div>
</div>
<section id="introduction" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">17.1</span> Introduction</h2>
<p>In this assignment we will learn how to run the chi-square goodness-of-fit test. A chi-square goodness-of-fit test is similar to a test for a single proportion except, instead of two categories (success/failure), we now try to understand the distribution among three or more categories.</p>
<section id="install-new-packages" class="level3" data-number="17.1.1">
<h3 data-number="17.1.1" class="anchored" data-anchor-id="install-new-packages"><span class="header-section-number">17.1.1</span> Install new packages</h3>
<p>There are no new packages used in this chapter.</p>
</section>
<section id="download-the-quarto-file" class="level3" data-number="17.1.2">
<h3 data-number="17.1.2" class="anchored" data-anchor-id="download-the-quarto-file"><span class="header-section-number">17.1.2</span> Download the Quarto file</h3>
<p>Look at either the top (Posit Cloud) or the upper right corner of the RStudio screen to make sure you are in your <code>intro_stats</code> project.</p>
<p>Then click on the following link to download this chapter as a Quarto file (<code>.qmd</code>).</p>
<p><a href="https://vectorposse.github.io/intro_stats/chapter_downloads/17-chi_square_goodness_of_fit.qmd" download="">https://vectorposse.github.io/intro_stats/chapter_downloads/17-chi_square_goodness_of_fit.qmd</a></p>
<p>Once the file is downloaded, move it to your project folder in RStudio and open it there.</p>
</section>
<section id="restart-r-and-run-all-chunks" class="level3" data-number="17.1.3">
<h3 data-number="17.1.3" class="anchored" data-anchor-id="restart-r-and-run-all-chunks"><span class="header-section-number">17.1.3</span> Restart R and run all chunks</h3>
<p>In RStudio, select “Restart R and Run All Chunks” from the “Run” menu.</p>
</section>
</section>
<section id="load-packages" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="load-packages"><span class="header-section-number">17.2</span> Load packages</h2>
<p>We load the standard <code>tidyverse</code>, <code>janitor</code>, and <code>infer</code> packages and the <code>openintro</code> package for the <code>hsb2</code> data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'

The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: airports
Loading required package: cherryblossom
Loading required package: usdata</code></pre>
</div>
</div>
</section>
<section id="research-question" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="research-question"><span class="header-section-number">17.3</span> Research question</h2>
<p>We use a classic data set <code>mtcars</code> from a 1974 Motor Trend magazine to examine the distribution of the number of engine cylinders (with values 4, 6, or 8). We’ll assume that this data set is representative of all cars from 1974.</p>
<p>In recent years, 4-cylinder vehicles and 6-cylinder vehicles have comprised about 38% of the market each, with nearly all the rest (24%) being 8-cylinder cars. (This ignores a very small number of cars manufactured with 3- or 5-cylinder engines.) Were car engines in 1974 manufactured according to the same distribution?</p>
<p>Here is the structure of the data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 32
Columns: 11
$ mpg  &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.8,…
$ cyl  &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4, 8,…
$ disp &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8, 16…
$ hp   &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, 180…
$ drat &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.92,…
$ wt   &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150, 3.…
$ qsec &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90, 18…
$ vs   &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0,…
$ am   &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0,…
$ gear &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3, 3,…
$ carb &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1, 2,…</code></pre>
</div>
</div>
<p>Note that the variable of interest <code>cyl</code> is not coded as a factor variable. Let’s convert <code>cyl</code> to a factor variable first. (Since the levels are already called 4, 6, and 8, we do not need to specify <code>levels</code> or <code>labels</code>.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cyl_fct =</span> <span class="fu">factor</span>(cyl))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["disp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["drat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["am"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["gear"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["carb"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["cyl_fct"],"name":[12],"type":["fct"],"align":["left"]}],"data":[{"1":"21.0","2":"6","3":"160.0","4":"110","5":"3.90","6":"2.620","7":"16.46","8":"0","9":"1","10":"4","11":"4","12":"6","_rn_":"Mazda RX4"},{"1":"21.0","2":"6","3":"160.0","4":"110","5":"3.90","6":"2.875","7":"17.02","8":"0","9":"1","10":"4","11":"4","12":"6","_rn_":"Mazda RX4 Wag"},{"1":"22.8","2":"4","3":"108.0","4":"93","5":"3.85","6":"2.320","7":"18.61","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Datsun 710"},{"1":"21.4","2":"6","3":"258.0","4":"110","5":"3.08","6":"3.215","7":"19.44","8":"1","9":"0","10":"3","11":"1","12":"6","_rn_":"Hornet 4 Drive"},{"1":"18.7","2":"8","3":"360.0","4":"175","5":"3.15","6":"3.440","7":"17.02","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"Hornet Sportabout"},{"1":"18.1","2":"6","3":"225.0","4":"105","5":"2.76","6":"3.460","7":"20.22","8":"1","9":"0","10":"3","11":"1","12":"6","_rn_":"Valiant"},{"1":"14.3","2":"8","3":"360.0","4":"245","5":"3.21","6":"3.570","7":"15.84","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Duster 360"},{"1":"24.4","2":"4","3":"146.7","4":"62","5":"3.69","6":"3.190","7":"20.00","8":"1","9":"0","10":"4","11":"2","12":"4","_rn_":"Merc 240D"},{"1":"22.8","2":"4","3":"140.8","4":"95","5":"3.92","6":"3.150","7":"22.90","8":"1","9":"0","10":"4","11":"2","12":"4","_rn_":"Merc 230"},{"1":"19.2","2":"6","3":"167.6","4":"123","5":"3.92","6":"3.440","7":"18.30","8":"1","9":"0","10":"4","11":"4","12":"6","_rn_":"Merc 280"},{"1":"17.8","2":"6","3":"167.6","4":"123","5":"3.92","6":"3.440","7":"18.90","8":"1","9":"0","10":"4","11":"4","12":"6","_rn_":"Merc 280C"},{"1":"16.4","2":"8","3":"275.8","4":"180","5":"3.07","6":"4.070","7":"17.40","8":"0","9":"0","10":"3","11":"3","12":"8","_rn_":"Merc 450SE"},{"1":"17.3","2":"8","3":"275.8","4":"180","5":"3.07","6":"3.730","7":"17.60","8":"0","9":"0","10":"3","11":"3","12":"8","_rn_":"Merc 450SL"},{"1":"15.2","2":"8","3":"275.8","4":"180","5":"3.07","6":"3.780","7":"18.00","8":"0","9":"0","10":"3","11":"3","12":"8","_rn_":"Merc 450SLC"},{"1":"10.4","2":"8","3":"472.0","4":"205","5":"2.93","6":"5.250","7":"17.98","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Cadillac Fleetwood"},{"1":"10.4","2":"8","3":"460.0","4":"215","5":"3.00","6":"5.424","7":"17.82","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Lincoln Continental"},{"1":"14.7","2":"8","3":"440.0","4":"230","5":"3.23","6":"5.345","7":"17.42","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Chrysler Imperial"},{"1":"32.4","2":"4","3":"78.7","4":"66","5":"4.08","6":"2.200","7":"19.47","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Fiat 128"},{"1":"30.4","2":"4","3":"75.7","4":"52","5":"4.93","6":"1.615","7":"18.52","8":"1","9":"1","10":"4","11":"2","12":"4","_rn_":"Honda Civic"},{"1":"33.9","2":"4","3":"71.1","4":"65","5":"4.22","6":"1.835","7":"19.90","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Toyota Corolla"},{"1":"21.5","2":"4","3":"120.1","4":"97","5":"3.70","6":"2.465","7":"20.01","8":"1","9":"0","10":"3","11":"1","12":"4","_rn_":"Toyota Corona"},{"1":"15.5","2":"8","3":"318.0","4":"150","5":"2.76","6":"3.520","7":"16.87","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"Dodge Challenger"},{"1":"15.2","2":"8","3":"304.0","4":"150","5":"3.15","6":"3.435","7":"17.30","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"AMC Javelin"},{"1":"13.3","2":"8","3":"350.0","4":"245","5":"3.73","6":"3.840","7":"15.41","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Camaro Z28"},{"1":"19.2","2":"8","3":"400.0","4":"175","5":"3.08","6":"3.845","7":"17.05","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"Pontiac Firebird"},{"1":"27.3","2":"4","3":"79.0","4":"66","5":"4.08","6":"1.935","7":"18.90","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Fiat X1-9"},{"1":"26.0","2":"4","3":"120.3","4":"91","5":"4.43","6":"2.140","7":"16.70","8":"0","9":"1","10":"5","11":"2","12":"4","_rn_":"Porsche 914-2"},{"1":"30.4","2":"4","3":"95.1","4":"113","5":"3.77","6":"1.513","7":"16.90","8":"1","9":"1","10":"5","11":"2","12":"4","_rn_":"Lotus Europa"},{"1":"15.8","2":"8","3":"351.0","4":"264","5":"4.22","6":"3.170","7":"14.50","8":"0","9":"1","10":"5","11":"4","12":"8","_rn_":"Ford Pantera L"},{"1":"19.7","2":"6","3":"145.0","4":"175","5":"3.62","6":"2.770","7":"15.50","8":"0","9":"1","10":"5","11":"6","12":"6","_rn_":"Ferrari Dino"},{"1":"15.0","2":"8","3":"301.0","4":"335","5":"3.54","6":"3.570","7":"14.60","8":"0","9":"1","10":"5","11":"8","12":"8","_rn_":"Maserati Bora"},{"1":"21.4","2":"4","3":"121.0","4":"109","5":"4.11","6":"2.780","7":"18.60","8":"1","9":"1","10":"4","11":"2","12":"4","_rn_":"Volvo 142E"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 32
Columns: 12
$ mpg     &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17…
$ cyl     &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4,…
$ disp    &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8,…
$ hp      &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, …
$ drat    &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.…
$ wt      &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150,…
$ qsec    &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90,…
$ vs      &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,…
$ am      &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0,…
$ gear    &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3,…
$ carb    &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1,…
$ cyl_fct &lt;fct&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4,…</code></pre>
</div>
</div>
</section>
<section id="chi-squared" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="chi-squared"><span class="header-section-number">17.4</span> Chi-squared</h2>
<p>When we have three or more categories in a categorical variable, it is natural to ask how the observed counts in each category compare to the counts that we expect to see under the assumption of some null hypothesis. In other words, we’re assuming that there is some “true” distribution to which we are going to compare our data. Sometimes, this null comes from substantive expert knowledge. (For example, we will be comparing the 1974 distribution to a known distribution from recent years.) Sometimes we’re interested to see if our data deviates from a null distribution that predicts an equal number of observations in each category.</p>
<p>First of all, what is the actual distribution of cylinders in our data? Here’s a frequency table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(mtcars, cyl_fct) <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>() <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["cyl_fct"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["percent"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"4","2":"11","3":"34.4%","_rn_":"1"},{"1":"6","2":"7","3":"21.9%","_rn_":"2"},{"1":"8","2":"14","3":"43.8%","_rn_":"3"},{"1":"Total","2":"32","3":"100.0%","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The counts of our frequency table (11, 7, and 14) are the “observed” values, usually denoted by the letter <span class="math inline">\(O\)</span> (uppercase “O”, which is a little unfortunate, because it also looks like a zero).</p>
<p>What are the expected counts? Well, since there are 32 cars, we need to multiply 32 by the percentages listed in the research question. For 4-cylinder and 6-cylinder cars, if the distribution of engines in 1974 were the same as today, there would be <span class="math inline">\(32 * 0.38\)</span> or about 12.2 cars we would expect to see in our sample that have 4-cylinder engines, and the same for 6-cylinder cars. For 8-cylinder cars, we expect <span class="math inline">\(32 * 0.24\)</span> or about 7.7 cars in our sample to have 8-cylinder engines. These “expected” counts are usually denoted by the letter <span class="math inline">\(E\)</span>.</p>
<p>Why aren’t the expected counts whole numbers? In any given data set, of course, we will see a whole number of cars with 4, 6, or 8 cylinders. However, since we’re looking only at expected counts, they are the average over lots of possible sets of 32 cars under the assumption of the null. We don’t need for these averages to be whole numbers.</p>
<p>How should the deviation between the data and the null distribution be measured? We could simply look at the difference between the observed counts and the expected counts <span class="math inline">\(O - E\)</span>. However, there will be some positive values (cells where we have more than the expected number of cars) and some negative values (cells where we have fewer than the expected number of cars). These will all cancel out.</p>
<p>If this sounds vaguely familiar, it is because we encountered the same problem with the formula for the standard deviation. The differences <span class="math inline">\(y - \bar{y}\)</span> had the same issue. Do you recall the solution in that case? It was to square these values, making them all positive.</p>
<p>So instead of <span class="math inline">\(O - E\)</span>, we will consider <span class="math inline">\((O - E)^{2}\)</span>. Finally, to make sure that cells with large expected values don’t dominate, we divide by <span class="math inline">\(E\)</span>:</p>
<p><span class="math display">\[
\frac{(O - E)^{2}}{E}.
\]</span></p>
<p>This puts each cell on equal footing. Now that we have a reasonable measure of the deviation between observed and expected counts for each cell, we can define the number <span class="math inline">\(\chi^{2}\)</span> as the sum of all these fractions, one for each cell.</p>
<p><span class="math display">\[
\chi^{2} = \sum \frac{(O - E)^{2}}{E}.
\]</span></p>
<p>Note: “Chi-squared” is pronounced “kye-squared.” The “ch” is a hard “k” sound, like “Chris” or “cholera” and not like “chai.” The vowel is a long “i”, so “Chi-squared” rhymes with “die-scared”, or if that’s too dark, how about “pie-shared.”<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>A <span class="math inline">\(\chi^{2}\)</span> value of zero would indicate perfect agreement between observed and expected values. As the <span class="math inline">\(\chi^{2}\)</span> value gets larger and larger, this indicates more and more deviation between observed and expected values.</p>
<p>As an example, for our data, we calculate chi-squared as follows:</p>
<p><span class="math display">\[
\chi^{2} = \frac{(11 - 12.2)^{2}}{12.2} + \frac{(7 - 12.2)^{2}}{12.2} + \frac{(14 - 7.7)^{2}}{7.7} \approx 7.5.
\]</span></p>
<p>Or we could just do it in R with the <code>infer</code> package. To do so, we have to state explicitly the proportions that correspond to the null hypothesis. In this case, since the order of entries in the frequency table is 4-cylinder, 6-cylinder, then 8-cylinder, we need to give <code>infer</code> a vector of entries <code>c("4" = 0.38, "6" = 0.38, "8" = 0.24)</code> that represents the 38%, 38%, and 24% expected for 4, 6, and 8 cylinders respectively.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>obs_chisq <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> cyl_fct) <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"point"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">p =</span> <span class="fu">c</span>(<span class="st">"4"</span> <span class="ot">=</span> <span class="fl">0.38</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"6"</span> <span class="ot">=</span> <span class="fl">0.38</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"8"</span> <span class="ot">=</span> <span class="fl">0.24</span>)) <span class="sc">|&gt;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"chisq"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>obs_chisq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"7.501096"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="the-chi-square-distribution" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="the-chi-square-distribution"><span class="header-section-number">17.5</span> The chi-square distribution</h2>
<p>We know that even if the true distribution were 38%, 38%, 24%, we would not see exactly 12.2, 12.2, 7.7 in a sample of 32 cars. (In fact, the “true” distribution is physically impossible because these are not whole numbers!) So what kinds of numbers could we get?</p>
<p>Let’s do a quick simulation to find out.</p>
<p>Under the assumption of the null, there should be a 38%, 38%, and 24% chance of seeing 4, 6, or 8 cylinders, respectively. To get a sense of the extent of sampling variability, we could use the <code>sample</code> command to see what happens in a sample of size 32 taken from a population where the true percentages are 38%, 38%, and 24%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99999</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sample1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="at">size =</span> <span class="dv">32</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.38</span>, <span class="fl">0.38</span>, <span class="fl">0.24</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>sample1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 6 8 4 8 6 6 8 4 8 6 8 6 6 4 6 8 4 6 6 8 8 6 6 8 4 8 6 4 4 4 6 4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sample1 <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sample1
 4  6  8 
 9 13 10 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sample2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="at">size =</span> <span class="dv">32</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.38</span>, <span class="fl">0.38</span>, <span class="fl">0.24</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>sample2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 6 8 8 8 4 4 8 4 8 6 8 4 4 6 6 6 6 4 4 4 6 4 4 4 8 4 4 8 4 4 4 8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sample2 <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sample2
 4  6  8 
16  7  9 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sample3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>), <span class="at">size =</span> <span class="dv">32</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.38</span>, <span class="fl">0.38</span>, <span class="fl">0.24</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>sample3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 8 6 4 6 6 6 6 4 6 6 6 4 6 4 8 8 6 8 8 8 4 6 8 4 8 6 6 6 6 8 4 6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sample3 <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sample3
 4  6  8 
 7 16  9 </code></pre>
</div>
</div>
<p>We can calculate the chi-squared value for each of these samples to get a sense of the possibilities. The <code>chisq.test</code> command from base R is a little unusual because it requires a frequency table (generated from the <code>table</code> command) as input. For purposes of hypothesis testing, we won’t need to use the <code>chisq.test</code> command directly because we will always use <code>infer</code> to do this work. But just to see some examples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sample1 <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>() <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  table(sample1)
X-squared = 0.8125, df = 2, p-value = 0.6661</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sample2 <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  table(sample2)
X-squared = 4.1875, df = 2, p-value = 0.1232</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sample3 <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  table(sample3)
X-squared = 4.1875, df = 2, p-value = 0.1232</code></pre>
</div>
</div>
<section id="exercise-1" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-1">Exercise 1</h5>
<p>Look more carefully at the three random samples above. Why does sample 1 have a chi-squared closer to 0 while samples 2 and 3 have a chi-squared values that are a little larger? (Hint: look at the counts of 4s, 6s, and 8s in those samples. How do those counts compare to the expected number of 4s, 6s, and 8s?)</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>The <code>infer</code> pipeline below (the <code>generate</code> command specifically) takes the values “4”, “6”, or “8” and grabs them at random according to the probabilities specified until it has 32 values. In other words, it will randomly select “4” about 38% of the time, “6” about 38% of the time, and “8” about 24% of the time, until it gets a list of 32 total cars. Then it will calculate the chi-squared value for that simulated set of 32 cars. But because randomness is involved, the simulated samples are subject to sampling variability and the chi-square values obtained will differ from each other. This is exactly what we did above with the <code>sample</code> command and the <code>chisq</code> command, but the benefit now is that we get 1000 random samples very quickly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99999</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>cyl_test_sim <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> cyl_fct) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"point"</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">p =</span> <span class="fu">c</span>(<span class="st">"4"</span> <span class="ot">=</span> <span class="fl">0.38</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"6"</span> <span class="ot">=</span> <span class="fl">0.38</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"8"</span> <span class="ot">=</span> <span class="fl">0.24</span>)) <span class="sc">|&gt;</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"draw"</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"chisq"</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>cyl_test_sim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["replicate"],"name":[1],"type":["int"],"align":["right"]},{"label":["stat"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1.58004386"},{"1":"2","2":"3.62911184"},{"1":"3","2":"3.62911184"},{"1":"4","2":"0.66858553"},{"1":"5","2":"2.31332237"},{"1":"6","2":"0.64802632"},{"1":"7","2":"4.12938596"},{"1":"8","2":"7.08305921"},{"1":"9","2":"0.64802632"},{"1":"10","2":"0.66858553"},{"1":"11","2":"0.67543860"},{"1":"12","2":"1.96381579"},{"1":"13","2":"2.64912281"},{"1":"14","2":"0.18201754"},{"1":"15","2":"3.19736842"},{"1":"16","2":"2.25849781"},{"1":"17","2":"0.48355263"},{"1":"18","2":"1.60060307"},{"1":"19","2":"1.60060307"},{"1":"20","2":"1.10718202"},{"1":"21","2":"3.40981360"},{"1":"22","2":"1.14144737"},{"1":"23","2":"1.08662281"},{"1":"24","2":"1.92955044"},{"1":"25","2":"3.62911184"},{"1":"26","2":"2.09402412"},{"1":"27","2":"1.96381579"},{"1":"28","2":"1.08662281"},{"1":"29","2":"1.60060307"},{"1":"30","2":"0.67543860"},{"1":"31","2":"0.12033991"},{"1":"32","2":"0.18201754"},{"1":"33","2":"2.48464912"},{"1":"34","2":"0.18201754"},{"1":"35","2":"2.31332237"},{"1":"36","2":"0.18201754"},{"1":"37","2":"2.91639254"},{"1":"38","2":"1.92955044"},{"1":"39","2":"1.92955044"},{"1":"40","2":"1.92955044"},{"1":"41","2":"0.92214912"},{"1":"42","2":"1.27165570"},{"1":"43","2":"1.32648026"},{"1":"44","2":"2.64912281"},{"1":"45","2":"3.40981360"},{"1":"46","2":"0.92214912"},{"1":"47","2":"5.21902412"},{"1":"48","2":"0.67543860"},{"1":"49","2":"4.12253289"},{"1":"50","2":"3.36184211"},{"1":"51","2":"1.92955044"},{"1":"52","2":"0.66858553"},{"1":"53","2":"4.95175439"},{"1":"54","2":"0.66858553"},{"1":"55","2":"2.09402412"},{"1":"56","2":"2.48464912"},{"1":"57","2":"3.80043860"},{"1":"58","2":"1.60060307"},{"1":"59","2":"1.10718202"},{"1":"60","2":"2.09402412"},{"1":"61","2":"0.67543860"},{"1":"62","2":"5.87691886"},{"1":"63","2":"4.78042763"},{"1":"64","2":"1.49780702"},{"1":"65","2":"2.40241228"},{"1":"66","2":"4.12938596"},{"1":"67","2":"0.64802632"},{"1":"68","2":"0.12033991"},{"1":"69","2":"1.58004386"},{"1":"70","2":"3.62911184"},{"1":"71","2":"1.10718202"},{"1":"72","2":"0.33963816"},{"1":"73","2":"1.92955044"},{"1":"74","2":"2.64912281"},{"1":"75","2":"0.64802632"},{"1":"76","2":"3.11513158"},{"1":"77","2":"1.60060307"},{"1":"78","2":"0.64802632"},{"1":"79","2":"0.64802632"},{"1":"80","2":"3.36184211"},{"1":"81","2":"3.62911184"},{"1":"82","2":"1.10718202"},{"1":"83","2":"0.18201754"},{"1":"84","2":"1.08662281"},{"1":"85","2":"2.64912281"},{"1":"86","2":"6.20586623"},{"1":"87","2":"2.25849781"},{"1":"88","2":"0.44928728"},{"1":"89","2":"2.91639254"},{"1":"90","2":"0.44928728"},{"1":"91","2":"1.58004386"},{"1":"92","2":"0.64802632"},{"1":"93","2":"1.10718202"},{"1":"94","2":"4.56112939"},{"1":"95","2":"1.08662281"},{"1":"96","2":"0.44928728"},{"1":"97","2":"1.08662281"},{"1":"98","2":"1.08662281"},{"1":"99","2":"3.85526316"},{"1":"100","2":"0.64802632"},{"1":"101","2":"1.58004386"},{"1":"102","2":"0.92214912"},{"1":"103","2":"1.32648026"},{"1":"104","2":"0.64802632"},{"1":"105","2":"0.67543860"},{"1":"106","2":"2.48464912"},{"1":"107","2":"1.92955044"},{"1":"108","2":"0.12033991"},{"1":"109","2":"2.09402412"},{"1":"110","2":"2.31332237"},{"1":"111","2":"0.64802632"},{"1":"112","2":"0.33963816"},{"1":"113","2":"1.27165570"},{"1":"114","2":"4.59539474"},{"1":"115","2":"1.32648026"},{"1":"116","2":"0.12033991"},{"1":"117","2":"0.33963816"},{"1":"118","2":"1.27165570"},{"1":"119","2":"0.64802632"},{"1":"120","2":"1.58004386"},{"1":"121","2":"2.25849781"},{"1":"122","2":"1.08662281"},{"1":"123","2":"0.12033991"},{"1":"124","2":"2.97807018"},{"1":"125","2":"1.32648026"},{"1":"126","2":"1.10718202"},{"1":"127","2":"0.67543860"},{"1":"128","2":"0.18201754"},{"1":"129","2":"0.12033991"},{"1":"130","2":"0.92214912"},{"1":"131","2":"4.59539474"},{"1":"132","2":"1.14144737"},{"1":"133","2":"1.92955044"},{"1":"134","2":"0.66858553"},{"1":"135","2":"2.25849781"},{"1":"136","2":"0.18201754"},{"1":"137","2":"3.36184211"},{"1":"138","2":"4.78042763"},{"1":"139","2":"0.44928728"},{"1":"140","2":"0.44928728"},{"1":"141","2":"1.32648026"},{"1":"142","2":"0.64802632"},{"1":"143","2":"0.44928728"},{"1":"144","2":"2.48464912"},{"1":"145","2":"1.32648026"},{"1":"146","2":"0.48355263"},{"1":"147","2":"3.62911184"},{"1":"148","2":"4.89007675"},{"1":"149","2":"3.19736842"},{"1":"150","2":"1.08662281"},{"1":"151","2":"3.24533991"},{"1":"152","2":"5.21902412"},{"1":"153","2":"0.64802632"},{"1":"154","2":"0.33963816"},{"1":"155","2":"4.95175439"},{"1":"156","2":"0.44928728"},{"1":"157","2":"0.48355263"},{"1":"158","2":"1.27165570"},{"1":"159","2":"1.10718202"},{"1":"160","2":"2.97807018"},{"1":"161","2":"0.18201754"},{"1":"162","2":"2.91639254"},{"1":"163","2":"2.40241228"},{"1":"164","2":"5.69188596"},{"1":"165","2":"0.66858553"},{"1":"166","2":"1.32648026"},{"1":"167","2":"0.64802632"},{"1":"168","2":"0.92214912"},{"1":"169","2":"1.32648026"},{"1":"170","2":"2.09402412"},{"1":"171","2":"6.86376096"},{"1":"172","2":"0.67543860"},{"1":"173","2":"0.18201754"},{"1":"174","2":"0.33963816"},{"1":"175","2":"2.64912281"},{"1":"176","2":"0.18201754"},{"1":"177","2":"0.18201754"},{"1":"178","2":"2.40241228"},{"1":"179","2":"7.00767544"},{"1":"180","2":"2.48464912"},{"1":"181","2":"1.92955044"},{"1":"182","2":"0.48355263"},{"1":"183","2":"0.12033991"},{"1":"184","2":"1.92955044"},{"1":"185","2":"7.00767544"},{"1":"186","2":"0.92214912"},{"1":"187","2":"1.92955044"},{"1":"188","2":"0.44928728"},{"1":"189","2":"2.25849781"},{"1":"190","2":"0.66858553"},{"1":"191","2":"3.55372807"},{"1":"192","2":"3.19736842"},{"1":"193","2":"3.85526316"},{"1":"194","2":"0.64802632"},{"1":"195","2":"2.40241228"},{"1":"196","2":"0.33963816"},{"1":"197","2":"1.58004386"},{"1":"198","2":"1.58004386"},{"1":"199","2":"0.67543860"},{"1":"200","2":"3.24533991"},{"1":"201","2":"2.40241228"},{"1":"202","2":"1.08662281"},{"1":"203","2":"1.92955044"},{"1":"204","2":"0.44928728"},{"1":"205","2":"1.14144737"},{"1":"206","2":"1.08662281"},{"1":"207","2":"3.40981360"},{"1":"208","2":"3.90323465"},{"1":"209","2":"0.01754386"},{"1":"210","2":"3.79358553"},{"1":"211","2":"2.25849781"},{"1":"212","2":"1.96381579"},{"1":"213","2":"0.18201754"},{"1":"214","2":"1.96381579"},{"1":"215","2":"3.62911184"},{"1":"216","2":"1.10718202"},{"1":"217","2":"4.59539474"},{"1":"218","2":"4.59539474"},{"1":"219","2":"0.12033991"},{"1":"220","2":"4.95175439"},{"1":"221","2":"2.40241228"},{"1":"222","2":"0.66858553"},{"1":"223","2":"2.31332237"},{"1":"224","2":"0.44928728"},{"1":"225","2":"1.14144737"},{"1":"226","2":"0.64802632"},{"1":"227","2":"1.58004386"},{"1":"228","2":"0.67543860"},{"1":"229","2":"1.27165570"},{"1":"230","2":"0.44928728"},{"1":"231","2":"4.56112939"},{"1":"232","2":"3.36184211"},{"1":"233","2":"3.11513158"},{"1":"234","2":"2.31332237"},{"1":"235","2":"5.87691886"},{"1":"236","2":"0.12033991"},{"1":"237","2":"1.08662281"},{"1":"238","2":"3.80043860"},{"1":"239","2":"0.64802632"},{"1":"240","2":"0.18201754"},{"1":"241","2":"7.00767544"},{"1":"242","2":"0.67543860"},{"1":"243","2":"2.48464912"},{"1":"244","2":"1.49780702"},{"1":"245","2":"1.27165570"},{"1":"246","2":"3.40981360"},{"1":"247","2":"2.64912281"},{"1":"248","2":"2.48464912"},{"1":"249","2":"1.60060307"},{"1":"250","2":"1.32648026"},{"1":"251","2":"0.64802632"},{"1":"252","2":"4.12938596"},{"1":"253","2":"2.64912281"},{"1":"254","2":"3.11513158"},{"1":"255","2":"0.12033991"},{"1":"256","2":"0.66858553"},{"1":"257","2":"2.40241228"},{"1":"258","2":"2.25849781"},{"1":"259","2":"1.58004386"},{"1":"260","2":"0.01754386"},{"1":"261","2":"4.12253289"},{"1":"262","2":"0.67543860"},{"1":"263","2":"0.33963816"},{"1":"264","2":"0.18201754"},{"1":"265","2":"0.64802632"},{"1":"266","2":"0.01754386"},{"1":"267","2":"0.12033991"},{"1":"268","2":"1.49780702"},{"1":"269","2":"0.44928728"},{"1":"270","2":"1.14144737"},{"1":"271","2":"0.44928728"},{"1":"272","2":"1.08662281"},{"1":"273","2":"1.49780702"},{"1":"274","2":"1.92955044"},{"1":"275","2":"3.79358553"},{"1":"276","2":"2.31332237"},{"1":"277","2":"3.55372807"},{"1":"278","2":"6.84320175"},{"1":"279","2":"3.62911184"},{"1":"280","2":"2.91639254"},{"1":"281","2":"1.08662281"},{"1":"282","2":"1.27165570"},{"1":"283","2":"0.18201754"},{"1":"284","2":"9.11842105"},{"1":"285","2":"3.24533991"},{"1":"286","2":"4.56112939"},{"1":"287","2":"0.44928728"},{"1":"288","2":"1.92955044"},{"1":"289","2":"0.12033991"},{"1":"290","2":"1.32648026"},{"1":"291","2":"2.31332237"},{"1":"292","2":"2.32017544"},{"1":"293","2":"1.27165570"},{"1":"294","2":"1.14144737"},{"1":"295","2":"2.64912281"},{"1":"296","2":"3.85526316"},{"1":"297","2":"0.18201754"},{"1":"298","2":"0.66858553"},{"1":"299","2":"0.18201754"},{"1":"300","2":"0.64802632"},{"1":"301","2":"0.66858553"},{"1":"302","2":"8.07675439"},{"1":"303","2":"0.44928728"},{"1":"304","2":"1.08662281"},{"1":"305","2":"0.33963816"},{"1":"306","2":"7.00767544"},{"1":"307","2":"3.80043860"},{"1":"308","2":"1.58004386"},{"1":"309","2":"3.62911184"},{"1":"310","2":"5.27384868"},{"1":"311","2":"2.48464912"},{"1":"312","2":"0.64802632"},{"1":"313","2":"1.08662281"},{"1":"314","2":"0.01754386"},{"1":"315","2":"2.09402412"},{"1":"316","2":"6.86376096"},{"1":"317","2":"1.10718202"},{"1":"318","2":"2.64912281"},{"1":"319","2":"0.18201754"},{"1":"320","2":"0.12033991"},{"1":"321","2":"2.25849781"},{"1":"322","2":"2.09402412"},{"1":"323","2":"4.12253289"},{"1":"324","2":"4.12253289"},{"1":"325","2":"0.67543860"},{"1":"326","2":"3.19736842"},{"1":"327","2":"3.36184211"},{"1":"328","2":"3.11513158"},{"1":"329","2":"7.02823465"},{"1":"330","2":"1.14144737"},{"1":"331","2":"1.49780702"},{"1":"332","2":"0.33963816"},{"1":"333","2":"3.24533991"},{"1":"334","2":"2.25849781"},{"1":"335","2":"3.40981360"},{"1":"336","2":"3.40981360"},{"1":"337","2":"0.44928728"},{"1":"338","2":"0.92214912"},{"1":"339","2":"0.44928728"},{"1":"340","2":"2.64912281"},{"1":"341","2":"0.18201754"},{"1":"342","2":"0.67543860"},{"1":"343","2":"2.09402412"},{"1":"344","2":"1.58004386"},{"1":"345","2":"6.43201754"},{"1":"346","2":"2.25849781"},{"1":"347","2":"1.92955044"},{"1":"348","2":"0.48355263"},{"1":"349","2":"0.33963816"},{"1":"350","2":"0.67543860"},{"1":"351","2":"0.18201754"},{"1":"352","2":"0.64802632"},{"1":"353","2":"8.72779605"},{"1":"354","2":"5.05455044"},{"1":"355","2":"1.10718202"},{"1":"356","2":"1.96381579"},{"1":"357","2":"0.48355263"},{"1":"358","2":"1.92955044"},{"1":"359","2":"2.40241228"},{"1":"360","2":"4.67763158"},{"1":"361","2":"2.64912281"},{"1":"362","2":"2.64912281"},{"1":"363","2":"0.67543860"},{"1":"364","2":"3.36184211"},{"1":"365","2":"5.03399123"},{"1":"366","2":"0.67543860"},{"1":"367","2":"0.18201754"},{"1":"368","2":"0.92214912"},{"1":"369","2":"0.12033991"},{"1":"370","2":"0.44928728"},{"1":"371","2":"0.18201754"},{"1":"372","2":"1.10718202"},{"1":"373","2":"1.10718202"},{"1":"374","2":"2.91639254"},{"1":"375","2":"1.58004386"},{"1":"376","2":"1.14144737"},{"1":"377","2":"8.15899123"},{"1":"378","2":"5.52741228"},{"1":"379","2":"1.32648026"},{"1":"380","2":"1.14144737"},{"1":"381","2":"0.66858553"},{"1":"382","2":"0.48355263"},{"1":"383","2":"1.14144737"},{"1":"384","2":"3.11513158"},{"1":"385","2":"4.89007675"},{"1":"386","2":"1.10718202"},{"1":"387","2":"3.85526316"},{"1":"388","2":"1.92955044"},{"1":"389","2":"0.33963816"},{"1":"390","2":"1.58004386"},{"1":"391","2":"2.91639254"},{"1":"392","2":"0.64802632"},{"1":"393","2":"0.44928728"},{"1":"394","2":"0.44928728"},{"1":"395","2":"1.96381579"},{"1":"396","2":"0.18201754"},{"1":"397","2":"0.66858553"},{"1":"398","2":"3.62911184"},{"1":"399","2":"0.48355263"},{"1":"400","2":"3.62911184"},{"1":"401","2":"2.09402412"},{"1":"402","2":"1.14144737"},{"1":"403","2":"0.33963816"},{"1":"404","2":"0.67543860"},{"1":"405","2":"4.78042763"},{"1":"406","2":"0.44928728"},{"1":"407","2":"0.48355263"},{"1":"408","2":"0.12033991"},{"1":"409","2":"0.01754386"},{"1":"410","2":"2.91639254"},{"1":"411","2":"4.56112939"},{"1":"412","2":"3.40981360"},{"1":"413","2":"0.64802632"},{"1":"414","2":"1.10718202"},{"1":"415","2":"1.58004386"},{"1":"416","2":"3.24533991"},{"1":"417","2":"1.10718202"},{"1":"418","2":"3.85526316"},{"1":"419","2":"0.66858553"},{"1":"420","2":"3.90323465"},{"1":"421","2":"0.44928728"},{"1":"422","2":"1.49780702"},{"1":"423","2":"0.67543860"},{"1":"424","2":"4.78042763"},{"1":"425","2":"4.56112939"},{"1":"426","2":"1.96381579"},{"1":"427","2":"1.49780702"},{"1":"428","2":"2.48464912"},{"1":"429","2":"0.67543860"},{"1":"430","2":"2.64912281"},{"1":"431","2":"1.08662281"},{"1":"432","2":"0.18201754"},{"1":"433","2":"5.87691886"},{"1":"434","2":"0.64802632"},{"1":"435","2":"0.33963816"},{"1":"436","2":"2.40241228"},{"1":"437","2":"2.40241228"},{"1":"438","2":"2.40241228"},{"1":"439","2":"3.19736842"},{"1":"440","2":"0.66858553"},{"1":"441","2":"0.12033991"},{"1":"442","2":"3.80043860"},{"1":"443","2":"0.44928728"},{"1":"444","2":"3.24533991"},{"1":"445","2":"0.01754386"},{"1":"446","2":"1.58004386"},{"1":"447","2":"3.11513158"},{"1":"448","2":"1.10718202"},{"1":"449","2":"0.44928728"},{"1":"450","2":"0.33963816"},{"1":"451","2":"8.83744518"},{"1":"452","2":"0.18201754"},{"1":"453","2":"1.08662281"},{"1":"454","2":"1.27165570"},{"1":"455","2":"1.14144737"},{"1":"456","2":"1.10718202"},{"1":"457","2":"2.91639254"},{"1":"458","2":"2.32017544"},{"1":"459","2":"11.96244518"},{"1":"460","2":"3.36184211"},{"1":"461","2":"4.67763158"},{"1":"462","2":"0.12033991"},{"1":"463","2":"1.10718202"},{"1":"464","2":"0.12033991"},{"1":"465","2":"7.50109649"},{"1":"466","2":"0.44928728"},{"1":"467","2":"2.31332237"},{"1":"468","2":"0.48355263"},{"1":"469","2":"4.95175439"},{"1":"470","2":"5.21902412"},{"1":"471","2":"4.12938596"},{"1":"472","2":"1.14144737"},{"1":"473","2":"0.64802632"},{"1":"474","2":"1.10718202"},{"1":"475","2":"4.56112939"},{"1":"476","2":"5.69188596"},{"1":"477","2":"0.33963816"},{"1":"478","2":"0.44928728"},{"1":"479","2":"1.32648026"},{"1":"480","2":"2.25849781"},{"1":"481","2":"0.66858553"},{"1":"482","2":"1.49780702"},{"1":"483","2":"3.19736842"},{"1":"484","2":"3.62911184"},{"1":"485","2":"0.64802632"},{"1":"486","2":"3.55372807"},{"1":"487","2":"1.49780702"},{"1":"488","2":"1.32648026"},{"1":"489","2":"1.58004386"},{"1":"490","2":"1.96381579"},{"1":"491","2":"1.60060307"},{"1":"492","2":"2.32017544"},{"1":"493","2":"3.19736842"},{"1":"494","2":"2.97807018"},{"1":"495","2":"0.33963816"},{"1":"496","2":"3.55372807"},{"1":"497","2":"4.12253289"},{"1":"498","2":"0.12033991"},{"1":"499","2":"0.12033991"},{"1":"500","2":"0.33963816"},{"1":"501","2":"2.40241228"},{"1":"502","2":"1.08662281"},{"1":"503","2":"3.62911184"},{"1":"504","2":"0.33963816"},{"1":"505","2":"3.85526316"},{"1":"506","2":"0.18201754"},{"1":"507","2":"0.18201754"},{"1":"508","2":"3.36184211"},{"1":"509","2":"0.44928728"},{"1":"510","2":"0.64802632"},{"1":"511","2":"0.44928728"},{"1":"512","2":"4.56112939"},{"1":"513","2":"2.40241228"},{"1":"514","2":"2.09402412"},{"1":"515","2":"7.50109649"},{"1":"516","2":"0.67543860"},{"1":"517","2":"4.89007675"},{"1":"518","2":"1.10718202"},{"1":"519","2":"2.32017544"},{"1":"520","2":"2.31332237"},{"1":"521","2":"1.08662281"},{"1":"522","2":"3.80043860"},{"1":"523","2":"1.58004386"},{"1":"524","2":"1.10718202"},{"1":"525","2":"0.44928728"},{"1":"526","2":"0.67543860"},{"1":"527","2":"0.48355263"},{"1":"528","2":"7.08305921"},{"1":"529","2":"0.01754386"},{"1":"530","2":"4.12253289"},{"1":"531","2":"2.64912281"},{"1":"532","2":"9.63925439"},{"1":"533","2":"0.64802632"},{"1":"534","2":"1.92955044"},{"1":"535","2":"1.32648026"},{"1":"536","2":"1.14144737"},{"1":"537","2":"3.19736842"},{"1":"538","2":"2.25849781"},{"1":"539","2":"1.92955044"},{"1":"540","2":"0.18201754"},{"1":"541","2":"5.69188596"},{"1":"542","2":"1.96381579"},{"1":"543","2":"0.18201754"},{"1":"544","2":"1.14144737"},{"1":"545","2":"2.40241228"},{"1":"546","2":"7.24753289"},{"1":"547","2":"2.97807018"},{"1":"548","2":"2.09402412"},{"1":"549","2":"1.08662281"},{"1":"550","2":"1.14144737"},{"1":"551","2":"1.49780702"},{"1":"552","2":"1.14144737"},{"1":"553","2":"1.14144737"},{"1":"554","2":"0.44928728"},{"1":"555","2":"0.33963816"},{"1":"556","2":"3.80043860"},{"1":"557","2":"1.60060307"},{"1":"558","2":"2.31332237"},{"1":"559","2":"1.32648026"},{"1":"560","2":"2.25849781"},{"1":"561","2":"0.12033991"},{"1":"562","2":"0.33963816"},{"1":"563","2":"0.33963816"},{"1":"564","2":"4.78042763"},{"1":"565","2":"0.67543860"},{"1":"566","2":"0.33963816"},{"1":"567","2":"0.64802632"},{"1":"568","2":"0.44928728"},{"1":"569","2":"3.40981360"},{"1":"570","2":"0.18201754"},{"1":"571","2":"1.49780702"},{"1":"572","2":"1.92955044"},{"1":"573","2":"0.33963816"},{"1":"574","2":"0.33963816"},{"1":"575","2":"2.97807018"},{"1":"576","2":"0.01754386"},{"1":"577","2":"0.66858553"},{"1":"578","2":"1.27165570"},{"1":"579","2":"0.48355263"},{"1":"580","2":"3.90323465"},{"1":"581","2":"5.05455044"},{"1":"582","2":"1.10718202"},{"1":"583","2":"0.44928728"},{"1":"584","2":"0.12033991"},{"1":"585","2":"0.64802632"},{"1":"586","2":"1.60060307"},{"1":"587","2":"2.48464912"},{"1":"588","2":"1.10718202"},{"1":"589","2":"0.67543860"},{"1":"590","2":"0.18201754"},{"1":"591","2":"0.18201754"},{"1":"592","2":"2.40241228"},{"1":"593","2":"2.25849781"},{"1":"594","2":"3.40981360"},{"1":"595","2":"0.18201754"},{"1":"596","2":"1.08662281"},{"1":"597","2":"3.85526316"},{"1":"598","2":"2.97807018"},{"1":"599","2":"5.82894737"},{"1":"600","2":"1.08662281"},{"1":"601","2":"0.01754386"},{"1":"602","2":"4.89007675"},{"1":"603","2":"4.67763158"},{"1":"604","2":"8.17955044"},{"1":"605","2":"2.31332237"},{"1":"606","2":"1.08662281"},{"1":"607","2":"1.27165570"},{"1":"608","2":"3.62911184"},{"1":"609","2":"1.58004386"},{"1":"610","2":"5.21902412"},{"1":"611","2":"2.40241228"},{"1":"612","2":"1.60060307"},{"1":"613","2":"0.67543860"},{"1":"614","2":"2.31332237"},{"1":"615","2":"0.64802632"},{"1":"616","2":"0.01754386"},{"1":"617","2":"0.12033991"},{"1":"618","2":"1.08662281"},{"1":"619","2":"1.60060307"},{"1":"620","2":"0.33963816"},{"1":"621","2":"4.56112939"},{"1":"622","2":"3.24533991"},{"1":"623","2":"4.56112939"},{"1":"624","2":"0.18201754"},{"1":"625","2":"3.11513158"},{"1":"626","2":"0.01754386"},{"1":"627","2":"2.25849781"},{"1":"628","2":"3.24533991"},{"1":"629","2":"3.85526316"},{"1":"630","2":"0.92214912"},{"1":"631","2":"2.32017544"},{"1":"632","2":"5.03399123"},{"1":"633","2":"0.44928728"},{"1":"634","2":"1.32648026"},{"1":"635","2":"0.44928728"},{"1":"636","2":"3.80043860"},{"1":"637","2":"0.44928728"},{"1":"638","2":"1.10718202"},{"1":"639","2":"1.58004386"},{"1":"640","2":"2.09402412"},{"1":"641","2":"0.01754386"},{"1":"642","2":"0.48355263"},{"1":"643","2":"2.40241228"},{"1":"644","2":"9.33086623"},{"1":"645","2":"2.40241228"},{"1":"646","2":"0.64802632"},{"1":"647","2":"0.64802632"},{"1":"648","2":"0.44928728"},{"1":"649","2":"1.58004386"},{"1":"650","2":"1.10718202"},{"1":"651","2":"3.36184211"},{"1":"652","2":"5.76726974"},{"1":"653","2":"0.33963816"},{"1":"654","2":"1.58004386"},{"1":"655","2":"1.32648026"},{"1":"656","2":"2.31332237"},{"1":"657","2":"4.95175439"},{"1":"658","2":"0.33963816"},{"1":"659","2":"0.18201754"},{"1":"660","2":"0.92214912"},{"1":"661","2":"6.18530702"},{"1":"662","2":"3.80043860"},{"1":"663","2":"2.48464912"},{"1":"664","2":"0.48355263"},{"1":"665","2":"1.49780702"},{"1":"666","2":"0.12033991"},{"1":"667","2":"0.64802632"},{"1":"668","2":"3.62911184"},{"1":"669","2":"1.08662281"},{"1":"670","2":"2.09402412"},{"1":"671","2":"1.60060307"},{"1":"672","2":"0.64802632"},{"1":"673","2":"3.80043860"},{"1":"674","2":"1.14144737"},{"1":"675","2":"8.17955044"},{"1":"676","2":"2.09402412"},{"1":"677","2":"8.24122807"},{"1":"678","2":"0.64802632"},{"1":"679","2":"5.87691886"},{"1":"680","2":"1.49780702"},{"1":"681","2":"0.67543860"},{"1":"682","2":"1.49780702"},{"1":"683","2":"2.09402412"},{"1":"684","2":"1.10718202"},{"1":"685","2":"1.14144737"},{"1":"686","2":"0.67543860"},{"1":"687","2":"0.18201754"},{"1":"688","2":"1.96381579"},{"1":"689","2":"1.49780702"},{"1":"690","2":"3.40981360"},{"1":"691","2":"1.14144737"},{"1":"692","2":"1.14144737"},{"1":"693","2":"1.14144737"},{"1":"694","2":"0.48355263"},{"1":"695","2":"6.18530702"},{"1":"696","2":"0.18201754"},{"1":"697","2":"5.76726974"},{"1":"698","2":"1.96381579"},{"1":"699","2":"1.60060307"},{"1":"700","2":"0.92214912"},{"1":"701","2":"0.33963816"},{"1":"702","2":"1.10718202"},{"1":"703","2":"0.64802632"},{"1":"704","2":"3.11513158"},{"1":"705","2":"2.31332237"},{"1":"706","2":"3.55372807"},{"1":"707","2":"2.91639254"},{"1":"708","2":"0.12033991"},{"1":"709","2":"3.11513158"},{"1":"710","2":"0.44928728"},{"1":"711","2":"0.18201754"},{"1":"712","2":"0.64802632"},{"1":"713","2":"0.33963816"},{"1":"714","2":"3.24533991"},{"1":"715","2":"0.92214912"},{"1":"716","2":"1.60060307"},{"1":"717","2":"2.25849781"},{"1":"718","2":"0.67543860"},{"1":"719","2":"3.36184211"},{"1":"720","2":"0.66858553"},{"1":"721","2":"3.80043860"},{"1":"722","2":"2.48464912"},{"1":"723","2":"1.27165570"},{"1":"724","2":"3.80043860"},{"1":"725","2":"0.48355263"},{"1":"726","2":"3.24533991"},{"1":"727","2":"2.64912281"},{"1":"728","2":"0.12033991"},{"1":"729","2":"1.14144737"},{"1":"730","2":"0.67543860"},{"1":"731","2":"4.56112939"},{"1":"732","2":"1.32648026"},{"1":"733","2":"1.60060307"},{"1":"734","2":"2.91639254"},{"1":"735","2":"5.21902412"},{"1":"736","2":"0.12033991"},{"1":"737","2":"4.89007675"},{"1":"738","2":"1.92955044"},{"1":"739","2":"1.27165570"},{"1":"740","2":"2.25849781"},{"1":"741","2":"0.18201754"},{"1":"742","2":"0.01754386"},{"1":"743","2":"0.67543860"},{"1":"744","2":"1.14144737"},{"1":"745","2":"0.33963816"},{"1":"746","2":"0.18201754"},{"1":"747","2":"2.09402412"},{"1":"748","2":"1.10718202"},{"1":"749","2":"0.12033991"},{"1":"750","2":"0.33963816"},{"1":"751","2":"0.12033991"},{"1":"752","2":"3.79358553"},{"1":"753","2":"0.18201754"},{"1":"754","2":"3.80043860"},{"1":"755","2":"4.56112939"},{"1":"756","2":"0.67543860"},{"1":"757","2":"0.44928728"},{"1":"758","2":"5.27384868"},{"1":"759","2":"1.08662281"},{"1":"760","2":"4.12938596"},{"1":"761","2":"0.92214912"},{"1":"762","2":"1.27165570"},{"1":"763","2":"5.52741228"},{"1":"764","2":"0.33963816"},{"1":"765","2":"0.67543860"},{"1":"766","2":"8.83744518"},{"1":"767","2":"2.31332237"},{"1":"768","2":"0.66858553"},{"1":"769","2":"0.18201754"},{"1":"770","2":"5.52741228"},{"1":"771","2":"0.64802632"},{"1":"772","2":"2.48464912"},{"1":"773","2":"1.14144737"},{"1":"774","2":"0.01754386"},{"1":"775","2":"10.95504386"},{"1":"776","2":"1.14144737"},{"1":"777","2":"1.27165570"},{"1":"778","2":"0.12033991"},{"1":"779","2":"0.64802632"},{"1":"780","2":"0.44928728"},{"1":"781","2":"0.33963816"},{"1":"782","2":"1.32648026"},{"1":"783","2":"2.32017544"},{"1":"784","2":"7.02823465"},{"1":"785","2":"0.66858553"},{"1":"786","2":"6.20586623"},{"1":"787","2":"0.01754386"},{"1":"788","2":"3.24533991"},{"1":"789","2":"1.58004386"},{"1":"790","2":"3.36184211"},{"1":"791","2":"0.01754386"},{"1":"792","2":"2.25849781"},{"1":"793","2":"4.12938596"},{"1":"794","2":"9.55016447"},{"1":"795","2":"0.66858553"},{"1":"796","2":"0.01754386"},{"1":"797","2":"0.12033991"},{"1":"798","2":"1.14144737"},{"1":"799","2":"0.01754386"},{"1":"800","2":"2.25849781"},{"1":"801","2":"5.21902412"},{"1":"802","2":"1.14144737"},{"1":"803","2":"0.92214912"},{"1":"804","2":"0.18201754"},{"1":"805","2":"5.82894737"},{"1":"806","2":"5.93859649"},{"1":"807","2":"0.44928728"},{"1":"808","2":"0.18201754"},{"1":"809","2":"2.09402412"},{"1":"810","2":"4.12938596"},{"1":"811","2":"0.18201754"},{"1":"812","2":"0.44928728"},{"1":"813","2":"2.31332237"},{"1":"814","2":"1.08662281"},{"1":"815","2":"2.48464912"},{"1":"816","2":"5.69188596"},{"1":"817","2":"1.60060307"},{"1":"818","2":"1.32648026"},{"1":"819","2":"0.44928728"},{"1":"820","2":"1.96381579"},{"1":"821","2":"3.11513158"},{"1":"822","2":"1.96381579"},{"1":"823","2":"0.18201754"},{"1":"824","2":"1.32648026"},{"1":"825","2":"0.01754386"},{"1":"826","2":"1.58004386"},{"1":"827","2":"0.66858553"},{"1":"828","2":"3.11513158"},{"1":"829","2":"0.64802632"},{"1":"830","2":"1.58004386"},{"1":"831","2":"0.01754386"},{"1":"832","2":"0.44928728"},{"1":"833","2":"0.64802632"},{"1":"834","2":"2.64912281"},{"1":"835","2":"0.12033991"},{"1":"836","2":"1.49780702"},{"1":"837","2":"2.25849781"},{"1":"838","2":"1.32648026"},{"1":"839","2":"0.18201754"},{"1":"840","2":"9.55016447"},{"1":"841","2":"1.96381579"},{"1":"842","2":"2.09402412"},{"1":"843","2":"3.85526316"},{"1":"844","2":"1.08662281"},{"1":"845","2":"1.32648026"},{"1":"846","2":"0.18201754"},{"1":"847","2":"1.14144737"},{"1":"848","2":"5.05455044"},{"1":"849","2":"11.14007675"},{"1":"850","2":"13.00411184"},{"1":"851","2":"0.44928728"},{"1":"852","2":"1.60060307"},{"1":"853","2":"5.05455044"},{"1":"854","2":"0.66858553"},{"1":"855","2":"0.67543860"},{"1":"856","2":"1.58004386"},{"1":"857","2":"1.10718202"},{"1":"858","2":"2.64912281"},{"1":"859","2":"0.33963816"},{"1":"860","2":"0.64802632"},{"1":"861","2":"0.18201754"},{"1":"862","2":"0.12033991"},{"1":"863","2":"1.27165570"},{"1":"864","2":"2.09402412"},{"1":"865","2":"1.92955044"},{"1":"866","2":"2.32017544"},{"1":"867","2":"1.32648026"},{"1":"868","2":"5.69188596"},{"1":"869","2":"0.44928728"},{"1":"870","2":"0.66858553"},{"1":"871","2":"0.44928728"},{"1":"872","2":"3.19736842"},{"1":"873","2":"2.25849781"},{"1":"874","2":"0.44928728"},{"1":"875","2":"1.27165570"},{"1":"876","2":"0.67543860"},{"1":"877","2":"0.44928728"},{"1":"878","2":"4.12253289"},{"1":"879","2":"1.08662281"},{"1":"880","2":"0.48355263"},{"1":"881","2":"4.12938596"},{"1":"882","2":"0.18201754"},{"1":"883","2":"0.18201754"},{"1":"884","2":"0.33963816"},{"1":"885","2":"3.24533991"},{"1":"886","2":"2.31332237"},{"1":"887","2":"1.08662281"},{"1":"888","2":"1.60060307"},{"1":"889","2":"2.32017544"},{"1":"890","2":"1.58004386"},{"1":"891","2":"0.12033991"},{"1":"892","2":"0.64802632"},{"1":"893","2":"1.10718202"},{"1":"894","2":"2.32017544"},{"1":"895","2":"0.12033991"},{"1":"896","2":"1.92955044"},{"1":"897","2":"1.32648026"},{"1":"898","2":"1.14144737"},{"1":"899","2":"3.36184211"},{"1":"900","2":"3.40981360"},{"1":"901","2":"0.67543860"},{"1":"902","2":"1.08662281"},{"1":"903","2":"1.14144737"},{"1":"904","2":"2.91639254"},{"1":"905","2":"1.08662281"},{"1":"906","2":"1.58004386"},{"1":"907","2":"4.95175439"},{"1":"908","2":"0.12033991"},{"1":"909","2":"4.56112939"},{"1":"910","2":"1.96381579"},{"1":"911","2":"3.90323465"},{"1":"912","2":"4.95175439"},{"1":"913","2":"2.32017544"},{"1":"914","2":"1.60060307"},{"1":"915","2":"0.33963816"},{"1":"916","2":"1.49780702"},{"1":"917","2":"0.44928728"},{"1":"918","2":"1.10718202"},{"1":"919","2":"0.12033991"},{"1":"920","2":"0.48355263"},{"1":"921","2":"1.27165570"},{"1":"922","2":"4.95175439"},{"1":"923","2":"0.67543860"},{"1":"924","2":"0.33963816"},{"1":"925","2":"2.48464912"},{"1":"926","2":"1.08662281"},{"1":"927","2":"8.15899123"},{"1":"928","2":"0.12033991"},{"1":"929","2":"3.80043860"},{"1":"930","2":"2.31332237"},{"1":"931","2":"6.43201754"},{"1":"932","2":"4.12938596"},{"1":"933","2":"3.24533991"},{"1":"934","2":"1.10718202"},{"1":"935","2":"0.33963816"},{"1":"936","2":"1.10718202"},{"1":"937","2":"0.48355263"},{"1":"938","2":"2.48464912"},{"1":"939","2":"3.11513158"},{"1":"940","2":"0.67543860"},{"1":"941","2":"10.26973684"},{"1":"942","2":"2.09402412"},{"1":"943","2":"3.62911184"},{"1":"944","2":"1.08662281"},{"1":"945","2":"0.66858553"},{"1":"946","2":"0.67543860"},{"1":"947","2":"0.12033991"},{"1":"948","2":"0.92214912"},{"1":"949","2":"0.18201754"},{"1":"950","2":"0.48355263"},{"1":"951","2":"0.48355263"},{"1":"952","2":"0.01754386"},{"1":"953","2":"0.18201754"},{"1":"954","2":"1.60060307"},{"1":"955","2":"4.67763158"},{"1":"956","2":"4.78042763"},{"1":"957","2":"2.64912281"},{"1":"958","2":"0.18201754"},{"1":"959","2":"0.67543860"},{"1":"960","2":"4.59539474"},{"1":"961","2":"3.80043860"},{"1":"962","2":"0.18201754"},{"1":"963","2":"3.11513158"},{"1":"964","2":"1.10718202"},{"1":"965","2":"5.76726974"},{"1":"966","2":"2.25849781"},{"1":"967","2":"1.27165570"},{"1":"968","2":"5.05455044"},{"1":"969","2":"0.12033991"},{"1":"970","2":"1.58004386"},{"1":"971","2":"0.44928728"},{"1":"972","2":"0.67543860"},{"1":"973","2":"2.91639254"},{"1":"974","2":"0.12033991"},{"1":"975","2":"0.64802632"},{"1":"976","2":"1.14144737"},{"1":"977","2":"1.08662281"},{"1":"978","2":"1.96381579"},{"1":"979","2":"1.08662281"},{"1":"980","2":"1.96381579"},{"1":"981","2":"3.40981360"},{"1":"982","2":"0.12033991"},{"1":"983","2":"2.48464912"},{"1":"984","2":"0.48355263"},{"1":"985","2":"0.48355263"},{"1":"986","2":"0.12033991"},{"1":"987","2":"0.92214912"},{"1":"988","2":"0.01754386"},{"1":"989","2":"5.21902412"},{"1":"990","2":"0.01754386"},{"1":"991","2":"1.58004386"},{"1":"992","2":"0.12033991"},{"1":"993","2":"2.64912281"},{"1":"994","2":"1.08662281"},{"1":"995","2":"4.67763158"},{"1":"996","2":"1.49780702"},{"1":"997","2":"0.66858553"},{"1":"998","2":"1.10718202"},{"1":"999","2":"0.48355263"},{"1":"1000","2":"0.12033991"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The “stat” column above contains 1000 random values of <span class="math inline">\(\chi^{2}\)</span>. Let’s graph these values and include the chi-squared value for our actual data in the same graph.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>cyl_test_sim <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visualize</span>() <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(obs_chisq, <span class="at">direction =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="17-chi_square_goodness_of_fit-web_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A few things are apparent:</p>
<ol type="1">
<li><p>The values are all positive. (The leftmost bar is sitting at 0, but it represents values greater than zero.) This makes sense when you remember that each piece of the <span class="math inline">\(\chi^{2}\)</span> calculation was positive. This is different from our earlier simulations that looked like normal models. (Z scores can be positive or negative, but not <span class="math inline">\(\chi^{2}\)</span>.)</p></li>
<li><p>This is a severely right-skewed graph. Although most values are near zero, the occasional unusual sample can have a large value of <span class="math inline">\(\chi^{2}\)</span>.</p></li>
<li><p>You can see that our sample (the red line) is pretty far to the right. It is an unusual value given the assumption of the null hypothesis. In fact, we can count the proportion of sampled values that are to the right of the red line:</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cyl_test_sim <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_p_value</span>(obs_chisq, <span class="at">direction =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["p_value"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.021"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This is the simulated P-value. Keep this number in mind when we calculate the P-value using a sampling distribution model below.</p>
</section>
</section>
<section id="chi-square-as-a-sampling-distribution-model" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="chi-square-as-a-sampling-distribution-model"><span class="header-section-number">17.6</span> Chi-square as a sampling distribution model</h2>
<p>Just like there was a mathematical model for our simulated data before (the normal model back then), there is also a mathematical model for this type of simulated data. It’s called (not surprisingly) the <em>chi-square distribution</em>.</p>
<p>There is one new idea, though. Although all normal models have the same bell shape, there are many different chi-square models. This is because the number of cells can change the sampling distribution. Our engine cylinder example has three cells (corresponding to the categories “4”, “6”, and “8”). But what if there were 10 categories? The shape of the chi-square model would be different.</p>
<p>The terminology used by statisticians to distinguish these models is <em>degrees of freedom</em>, abbreviated <span class="math inline">\(df\)</span>. The reason for this name and the mathematics behind it are somewhat technical. Suffice it to say for now that if there are <span class="math inline">\(c\)</span> cells, you use <span class="math inline">\(c - 1\)</span> degrees of freedom. For our car example, there are 3 cylinder categories, so <span class="math inline">\(df = 2\)</span>.</p>
<p>Look at the graph below that shows the theoretical chi-square models for varying degrees of freedom.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't worry about the syntax here.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># You won't need to know how to do this on your own.</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dchisq, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">2</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"2"</span>)) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dchisq, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">5</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"5"</span> )) <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dchisq, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">10</span>),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"10"</span>)) <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"df"</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"2"</span> <span class="ot">=</span> <span class="st">"red"</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"10"</span> <span class="ot">=</span> <span class="st">"green"</span>),</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span>  <span class="fu">c</span>(<span class="st">"2"</span>, <span class="st">"5"</span>, <span class="st">"10"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="17-chi_square_goodness_of_fit-web_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The red curve (corresponding to <span class="math inline">\(df = 2\)</span>) looks a lot like our simulation above. But as the degrees of freedom increase, the mode shifts further to the right.</p>
</section>
<section id="chi-square-goodness-of-fit-test" class="level2" data-number="17.7">
<h2 data-number="17.7" class="anchored" data-anchor-id="chi-square-goodness-of-fit-test"><span class="header-section-number">17.7</span> Chi-square goodness-of-fit test</h2>
<p>The formal inferential procedure for examining whether data from a categorical variable fits a proposed distribution in the population is called a <em>chi-square goodness-of-fit test</em>.</p>
<p>We can use the chi-square model as the sampling distribution as long as the sample size is large enough. This is checked by calculating that the expected cell counts (not the observed cell counts!) are at least 5 in each cell.</p>
<p>The following <code>infer</code> pipeline will run a hypothesis test using the theoretical chi-squared distribution with 2 degrees of freedom.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>cyl_test <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> cyl_fct) <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assume</span>(<span class="at">distribution =</span> <span class="st">"chisq"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>cyl_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A Chi-squared distribution with 2 degrees of freedom.</code></pre>
</div>
</div>
<p>Here is the theoretical distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>cyl_test <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visualize</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="17-chi_square_goodness_of_fit-web_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>And here it is with our test statistic (the chi-squared value for our observed data) marked:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>cyl_test <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visualize</span>() <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(obs_chisq, <span class="at">direction =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="17-chi_square_goodness_of_fit-web_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Finally, here is the P-value associated with the shaded area to the right of the test statistic:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>cyl_test <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_p_value</span>(obs_chisq, <span class="at">direction =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["p_value"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.02350486"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Note that this P-value is quite similar to the P-value derived from the simulation earlier.</p>
<p>We’ll walk through the engine cylinder example from top to bottom using the rubric. Most of this is just repeating work we’ve already done, but showing this work in the context of the rubric will help you as you take over in the “Your Turn” section later.</p>
</section>
<section id="exploratory-data-analysis" class="level2" data-number="17.8">
<h2 data-number="17.8" class="anchored" data-anchor-id="exploratory-data-analysis"><span class="header-section-number">17.8</span> Exploratory data analysis</h2>
<section id="use-data-documentation-help-files-code-books-google-etc.-to-determine-as-much-as-possible-about-the-data-provenance-and-structure." class="level3" data-number="17.8.1">
<h3 data-number="17.8.1" class="anchored" data-anchor-id="use-data-documentation-help-files-code-books-google-etc.-to-determine-as-much-as-possible-about-the-data-provenance-and-structure."><span class="header-section-number">17.8.1</span> Use data documentation (help files, code books, Google, etc.) to determine as much as possible about the data provenance and structure.</h3>
<p>Type <code>?mtcars</code> at the Console to read the help file. <em>Motor Trend</em> is a reputable publication and, therefore, we do not doubt the accuracy of the data. It’s not clear, however, why these specific 32 cars were chosen and if they reflect a representative sample of cars on the road in 1974.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["disp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["drat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["am"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["gear"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["carb"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["cyl_fct"],"name":[12],"type":["fct"],"align":["left"]}],"data":[{"1":"21.0","2":"6","3":"160.0","4":"110","5":"3.90","6":"2.620","7":"16.46","8":"0","9":"1","10":"4","11":"4","12":"6","_rn_":"Mazda RX4"},{"1":"21.0","2":"6","3":"160.0","4":"110","5":"3.90","6":"2.875","7":"17.02","8":"0","9":"1","10":"4","11":"4","12":"6","_rn_":"Mazda RX4 Wag"},{"1":"22.8","2":"4","3":"108.0","4":"93","5":"3.85","6":"2.320","7":"18.61","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Datsun 710"},{"1":"21.4","2":"6","3":"258.0","4":"110","5":"3.08","6":"3.215","7":"19.44","8":"1","9":"0","10":"3","11":"1","12":"6","_rn_":"Hornet 4 Drive"},{"1":"18.7","2":"8","3":"360.0","4":"175","5":"3.15","6":"3.440","7":"17.02","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"Hornet Sportabout"},{"1":"18.1","2":"6","3":"225.0","4":"105","5":"2.76","6":"3.460","7":"20.22","8":"1","9":"0","10":"3","11":"1","12":"6","_rn_":"Valiant"},{"1":"14.3","2":"8","3":"360.0","4":"245","5":"3.21","6":"3.570","7":"15.84","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Duster 360"},{"1":"24.4","2":"4","3":"146.7","4":"62","5":"3.69","6":"3.190","7":"20.00","8":"1","9":"0","10":"4","11":"2","12":"4","_rn_":"Merc 240D"},{"1":"22.8","2":"4","3":"140.8","4":"95","5":"3.92","6":"3.150","7":"22.90","8":"1","9":"0","10":"4","11":"2","12":"4","_rn_":"Merc 230"},{"1":"19.2","2":"6","3":"167.6","4":"123","5":"3.92","6":"3.440","7":"18.30","8":"1","9":"0","10":"4","11":"4","12":"6","_rn_":"Merc 280"},{"1":"17.8","2":"6","3":"167.6","4":"123","5":"3.92","6":"3.440","7":"18.90","8":"1","9":"0","10":"4","11":"4","12":"6","_rn_":"Merc 280C"},{"1":"16.4","2":"8","3":"275.8","4":"180","5":"3.07","6":"4.070","7":"17.40","8":"0","9":"0","10":"3","11":"3","12":"8","_rn_":"Merc 450SE"},{"1":"17.3","2":"8","3":"275.8","4":"180","5":"3.07","6":"3.730","7":"17.60","8":"0","9":"0","10":"3","11":"3","12":"8","_rn_":"Merc 450SL"},{"1":"15.2","2":"8","3":"275.8","4":"180","5":"3.07","6":"3.780","7":"18.00","8":"0","9":"0","10":"3","11":"3","12":"8","_rn_":"Merc 450SLC"},{"1":"10.4","2":"8","3":"472.0","4":"205","5":"2.93","6":"5.250","7":"17.98","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Cadillac Fleetwood"},{"1":"10.4","2":"8","3":"460.0","4":"215","5":"3.00","6":"5.424","7":"17.82","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Lincoln Continental"},{"1":"14.7","2":"8","3":"440.0","4":"230","5":"3.23","6":"5.345","7":"17.42","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Chrysler Imperial"},{"1":"32.4","2":"4","3":"78.7","4":"66","5":"4.08","6":"2.200","7":"19.47","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Fiat 128"},{"1":"30.4","2":"4","3":"75.7","4":"52","5":"4.93","6":"1.615","7":"18.52","8":"1","9":"1","10":"4","11":"2","12":"4","_rn_":"Honda Civic"},{"1":"33.9","2":"4","3":"71.1","4":"65","5":"4.22","6":"1.835","7":"19.90","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Toyota Corolla"},{"1":"21.5","2":"4","3":"120.1","4":"97","5":"3.70","6":"2.465","7":"20.01","8":"1","9":"0","10":"3","11":"1","12":"4","_rn_":"Toyota Corona"},{"1":"15.5","2":"8","3":"318.0","4":"150","5":"2.76","6":"3.520","7":"16.87","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"Dodge Challenger"},{"1":"15.2","2":"8","3":"304.0","4":"150","5":"3.15","6":"3.435","7":"17.30","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"AMC Javelin"},{"1":"13.3","2":"8","3":"350.0","4":"245","5":"3.73","6":"3.840","7":"15.41","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Camaro Z28"},{"1":"19.2","2":"8","3":"400.0","4":"175","5":"3.08","6":"3.845","7":"17.05","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"Pontiac Firebird"},{"1":"27.3","2":"4","3":"79.0","4":"66","5":"4.08","6":"1.935","7":"18.90","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Fiat X1-9"},{"1":"26.0","2":"4","3":"120.3","4":"91","5":"4.43","6":"2.140","7":"16.70","8":"0","9":"1","10":"5","11":"2","12":"4","_rn_":"Porsche 914-2"},{"1":"30.4","2":"4","3":"95.1","4":"113","5":"3.77","6":"1.513","7":"16.90","8":"1","9":"1","10":"5","11":"2","12":"4","_rn_":"Lotus Europa"},{"1":"15.8","2":"8","3":"351.0","4":"264","5":"4.22","6":"3.170","7":"14.50","8":"0","9":"1","10":"5","11":"4","12":"8","_rn_":"Ford Pantera L"},{"1":"19.7","2":"6","3":"145.0","4":"175","5":"3.62","6":"2.770","7":"15.50","8":"0","9":"1","10":"5","11":"6","12":"6","_rn_":"Ferrari Dino"},{"1":"15.0","2":"8","3":"301.0","4":"335","5":"3.54","6":"3.570","7":"14.60","8":"0","9":"1","10":"5","11":"8","12":"8","_rn_":"Maserati Bora"},{"1":"21.4","2":"4","3":"121.0","4":"109","5":"4.11","6":"2.780","7":"18.60","8":"1","9":"1","10":"4","11":"2","12":"4","_rn_":"Volvo 142E"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 32
Columns: 12
$ mpg     &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17…
$ cyl     &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4,…
$ disp    &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8,…
$ hp      &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, …
$ drat    &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.…
$ wt      &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150,…
$ qsec    &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90,…
$ vs      &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,…
$ am      &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0,…
$ gear    &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3,…
$ carb    &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1,…
$ cyl_fct &lt;fct&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4,…</code></pre>
</div>
</div>
</section>
<section id="prepare-the-data-for-analysis." class="level3" data-number="17.8.2">
<h3 data-number="17.8.2" class="anchored" data-anchor-id="prepare-the-data-for-analysis."><span class="header-section-number">17.8.2</span> Prepare the data for analysis.</h3>
<p>Check for missing data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cyl) <span class="sc">|&gt;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">NROW</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Although we've already done this above, </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we include it here again for completeness.</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>mtcars <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cyl_fct =</span> <span class="fu">factor</span>(cyl))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>mtcars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["mpg"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["cyl"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["disp"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["hp"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["drat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["wt"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["qsec"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["vs"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["am"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["gear"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["carb"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["cyl_fct"],"name":[12],"type":["fct"],"align":["left"]}],"data":[{"1":"21.0","2":"6","3":"160.0","4":"110","5":"3.90","6":"2.620","7":"16.46","8":"0","9":"1","10":"4","11":"4","12":"6","_rn_":"Mazda RX4"},{"1":"21.0","2":"6","3":"160.0","4":"110","5":"3.90","6":"2.875","7":"17.02","8":"0","9":"1","10":"4","11":"4","12":"6","_rn_":"Mazda RX4 Wag"},{"1":"22.8","2":"4","3":"108.0","4":"93","5":"3.85","6":"2.320","7":"18.61","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Datsun 710"},{"1":"21.4","2":"6","3":"258.0","4":"110","5":"3.08","6":"3.215","7":"19.44","8":"1","9":"0","10":"3","11":"1","12":"6","_rn_":"Hornet 4 Drive"},{"1":"18.7","2":"8","3":"360.0","4":"175","5":"3.15","6":"3.440","7":"17.02","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"Hornet Sportabout"},{"1":"18.1","2":"6","3":"225.0","4":"105","5":"2.76","6":"3.460","7":"20.22","8":"1","9":"0","10":"3","11":"1","12":"6","_rn_":"Valiant"},{"1":"14.3","2":"8","3":"360.0","4":"245","5":"3.21","6":"3.570","7":"15.84","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Duster 360"},{"1":"24.4","2":"4","3":"146.7","4":"62","5":"3.69","6":"3.190","7":"20.00","8":"1","9":"0","10":"4","11":"2","12":"4","_rn_":"Merc 240D"},{"1":"22.8","2":"4","3":"140.8","4":"95","5":"3.92","6":"3.150","7":"22.90","8":"1","9":"0","10":"4","11":"2","12":"4","_rn_":"Merc 230"},{"1":"19.2","2":"6","3":"167.6","4":"123","5":"3.92","6":"3.440","7":"18.30","8":"1","9":"0","10":"4","11":"4","12":"6","_rn_":"Merc 280"},{"1":"17.8","2":"6","3":"167.6","4":"123","5":"3.92","6":"3.440","7":"18.90","8":"1","9":"0","10":"4","11":"4","12":"6","_rn_":"Merc 280C"},{"1":"16.4","2":"8","3":"275.8","4":"180","5":"3.07","6":"4.070","7":"17.40","8":"0","9":"0","10":"3","11":"3","12":"8","_rn_":"Merc 450SE"},{"1":"17.3","2":"8","3":"275.8","4":"180","5":"3.07","6":"3.730","7":"17.60","8":"0","9":"0","10":"3","11":"3","12":"8","_rn_":"Merc 450SL"},{"1":"15.2","2":"8","3":"275.8","4":"180","5":"3.07","6":"3.780","7":"18.00","8":"0","9":"0","10":"3","11":"3","12":"8","_rn_":"Merc 450SLC"},{"1":"10.4","2":"8","3":"472.0","4":"205","5":"2.93","6":"5.250","7":"17.98","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Cadillac Fleetwood"},{"1":"10.4","2":"8","3":"460.0","4":"215","5":"3.00","6":"5.424","7":"17.82","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Lincoln Continental"},{"1":"14.7","2":"8","3":"440.0","4":"230","5":"3.23","6":"5.345","7":"17.42","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Chrysler Imperial"},{"1":"32.4","2":"4","3":"78.7","4":"66","5":"4.08","6":"2.200","7":"19.47","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Fiat 128"},{"1":"30.4","2":"4","3":"75.7","4":"52","5":"4.93","6":"1.615","7":"18.52","8":"1","9":"1","10":"4","11":"2","12":"4","_rn_":"Honda Civic"},{"1":"33.9","2":"4","3":"71.1","4":"65","5":"4.22","6":"1.835","7":"19.90","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Toyota Corolla"},{"1":"21.5","2":"4","3":"120.1","4":"97","5":"3.70","6":"2.465","7":"20.01","8":"1","9":"0","10":"3","11":"1","12":"4","_rn_":"Toyota Corona"},{"1":"15.5","2":"8","3":"318.0","4":"150","5":"2.76","6":"3.520","7":"16.87","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"Dodge Challenger"},{"1":"15.2","2":"8","3":"304.0","4":"150","5":"3.15","6":"3.435","7":"17.30","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"AMC Javelin"},{"1":"13.3","2":"8","3":"350.0","4":"245","5":"3.73","6":"3.840","7":"15.41","8":"0","9":"0","10":"3","11":"4","12":"8","_rn_":"Camaro Z28"},{"1":"19.2","2":"8","3":"400.0","4":"175","5":"3.08","6":"3.845","7":"17.05","8":"0","9":"0","10":"3","11":"2","12":"8","_rn_":"Pontiac Firebird"},{"1":"27.3","2":"4","3":"79.0","4":"66","5":"4.08","6":"1.935","7":"18.90","8":"1","9":"1","10":"4","11":"1","12":"4","_rn_":"Fiat X1-9"},{"1":"26.0","2":"4","3":"120.3","4":"91","5":"4.43","6":"2.140","7":"16.70","8":"0","9":"1","10":"5","11":"2","12":"4","_rn_":"Porsche 914-2"},{"1":"30.4","2":"4","3":"95.1","4":"113","5":"3.77","6":"1.513","7":"16.90","8":"1","9":"1","10":"5","11":"2","12":"4","_rn_":"Lotus Europa"},{"1":"15.8","2":"8","3":"351.0","4":"264","5":"4.22","6":"3.170","7":"14.50","8":"0","9":"1","10":"5","11":"4","12":"8","_rn_":"Ford Pantera L"},{"1":"19.7","2":"6","3":"145.0","4":"175","5":"3.62","6":"2.770","7":"15.50","8":"0","9":"1","10":"5","11":"6","12":"6","_rn_":"Ferrari Dino"},{"1":"15.0","2":"8","3":"301.0","4":"335","5":"3.54","6":"3.570","7":"14.60","8":"0","9":"1","10":"5","11":"8","12":"8","_rn_":"Maserati Bora"},{"1":"21.4","2":"4","3":"121.0","4":"109","5":"4.11","6":"2.780","7":"18.60","8":"1","9":"1","10":"4","11":"2","12":"4","_rn_":"Volvo 142E"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 32
Columns: 12
$ mpg     &lt;dbl&gt; 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17…
$ cyl     &lt;dbl&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4,…
$ disp    &lt;dbl&gt; 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8,…
$ hp      &lt;dbl&gt; 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, …
$ drat    &lt;dbl&gt; 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.…
$ wt      &lt;dbl&gt; 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150,…
$ qsec    &lt;dbl&gt; 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90,…
$ vs      &lt;dbl&gt; 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,…
$ am      &lt;dbl&gt; 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0,…
$ gear    &lt;dbl&gt; 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3,…
$ carb    &lt;dbl&gt; 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1,…
$ cyl_fct &lt;fct&gt; 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4,…</code></pre>
</div>
</div>
</section>
<section id="make-tables-or-plots-to-explore-the-data-visually." class="level3" data-number="17.8.3">
<h3 data-number="17.8.3" class="anchored" data-anchor-id="make-tables-or-plots-to-explore-the-data-visually."><span class="header-section-number">17.8.3</span> Make tables or plots to explore the data visually.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(mtcars, cyl_fct) <span class="sc">|&gt;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["cyl_fct"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["percent"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"4","2":"11","3":"34.4%","_rn_":"1"},{"1":"6","2":"7","3":"21.9%","_rn_":"2"},{"1":"8","2":"14","3":"43.8%","_rn_":"3"},{"1":"Total","2":"32","3":"100.0%","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="hypotheses" class="level2" data-number="17.9">
<h2 data-number="17.9" class="anchored" data-anchor-id="hypotheses"><span class="header-section-number">17.9</span> Hypotheses</h2>
<section id="identify-the-sample-or-samples-and-a-reasonable-population-or-populations-of-interest." class="level3" data-number="17.9.1">
<h3 data-number="17.9.1" class="anchored" data-anchor-id="identify-the-sample-or-samples-and-a-reasonable-population-or-populations-of-interest."><span class="header-section-number">17.9.1</span> Identify the sample (or samples) and a reasonable population (or populations) of interest.</h3>
<p>The sample is a set of 32 cars from a 1974 Motor Trends magazine. The population is all cars from 1974.</p>
</section>
<section id="express-the-null-and-alternative-hypotheses-as-contextually-meaningful-full-sentences." class="level3" data-number="17.9.2">
<h3 data-number="17.9.2" class="anchored" data-anchor-id="express-the-null-and-alternative-hypotheses-as-contextually-meaningful-full-sentences."><span class="header-section-number">17.9.2</span> Express the null and alternative hypotheses as contextually meaningful full sentences.</h3>
<p><span class="math inline">\(H_{0}:\)</span> In 1974, the proportion of cars with 4, 6, and 8 cylinders was 38%, 38%, and 24%, respectively.</p>
<p><span class="math inline">\(H_{A}:\)</span> In 1974, the proportion of cars with 4, 6, and 8 cylinders was not 38%, 38%, and 24%.</p>
</section>
<section id="express-the-null-and-alternative-hypotheses-in-symbols-when-possible." class="level3" data-number="17.9.3">
<h3 data-number="17.9.3" class="anchored" data-anchor-id="express-the-null-and-alternative-hypotheses-in-symbols-when-possible."><span class="header-section-number">17.9.3</span> Express the null and alternative hypotheses in symbols (when possible).</h3>
<p><span class="math inline">\(H_{0}: p_{4} = 0.38, p_{6} = 0.38, p_{8} = 0.24\)</span></p>
<p>There is no easy way to express the alternate hypothesis in symbols because any deviation in any of the categories can lead to rejection of the null. You can’t just say <span class="math inline">\(p_{4} \neq 0.38, p_{6} \neq 0.38, p_{8} \neq 0.24\)</span> because one of these categories might have the correct proportion with the other two different and that would still be consistent with the alternative hypothesis.</p>
<p>So the only requirement here is to express the null in symbols.</p>
</section>
</section>
<section id="model" class="level2" data-number="17.10">
<h2 data-number="17.10" class="anchored" data-anchor-id="model"><span class="header-section-number">17.10</span> Model</h2>
<section id="identify-the-sampling-distribution-model." class="level3" data-number="17.10.1">
<h3 data-number="17.10.1" class="anchored" data-anchor-id="identify-the-sampling-distribution-model."><span class="header-section-number">17.10.1</span> Identify the sampling distribution model.</h3>
<p>We use a <span class="math inline">\(\chi^{2}\)</span> model with 2 degrees of freedom.</p>
<p>Commentary: Unlike the normal model, there are infinitely many different <span class="math inline">\(\chi^{2}\)</span> models, so you have to specify the degrees of freedom when you identify it as the sampling distribution model.</p>
</section>
<section id="check-the-relevant-conditions-to-ensure-that-model-assumptions-are-met." class="level3" data-number="17.10.2">
<h3 data-number="17.10.2" class="anchored" data-anchor-id="check-the-relevant-conditions-to-ensure-that-model-assumptions-are-met."><span class="header-section-number">17.10.2</span> Check the relevant conditions to ensure that model assumptions are met.</h3>
<ul>
<li>Random
<ul>
<li>We do not know how Motor Trends magazine sampled these 32 cars, so we’re not sure if this list is random or representative of all cars from 1974. We should be cautious in our conclusions.</li>
</ul></li>
<li>10%
<ul>
<li>As long as there are at least 320 different car models, we are okay. This sounds like a lot, so this condition might not quite be met. Again, we need to be careful. (Also note that the population is not all automobiles manufactured in 1974. It is all <em>types</em> of automobile manufactured in 1974. There’s a big difference.)</li>
</ul></li>
<li>Expected cell counts
<ul>
<li>This condition says that under the null, we should see at least 5 cars in each category. The expected counts are <span class="math inline">\(32(0.38) = 12.2\)</span>, <span class="math inline">\(32(0.38) = 12.2\)</span>, and <span class="math inline">\(32(0.24) = 7.7\)</span>. So this condition is met.</li>
</ul></li>
</ul>
<p>Commentary: The expected counts condition is necessary for using the theoretical chi-squared distribution. If we were using simulation instead, we would not need this condition.</p>
</section>
</section>
<section id="mechanics" class="level2" data-number="17.11">
<h2 data-number="17.11" class="anchored" data-anchor-id="mechanics"><span class="header-section-number">17.11</span> Mechanics</h2>
<section id="compute-the-test-statistic." class="level3" data-number="17.11.1">
<h3 data-number="17.11.1" class="anchored" data-anchor-id="compute-the-test-statistic."><span class="header-section-number">17.11.1</span> Compute the test statistic.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>obs_chisq <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> cyl_fct) <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"point"</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">p =</span> <span class="fu">c</span>(<span class="st">"4"</span> <span class="ot">=</span> <span class="fl">0.38</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"6"</span> <span class="ot">=</span> <span class="fl">0.38</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"8"</span> <span class="ot">=</span> <span class="fl">0.24</span>)) <span class="sc">|&gt;</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"chisq"</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>obs_chisq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["stat"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"7.501096"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="report-the-test-statistic-in-context-when-possible." class="level3" data-number="17.11.2">
<h3 data-number="17.11.2" class="anchored" data-anchor-id="report-the-test-statistic-in-context-when-possible."><span class="header-section-number">17.11.2</span> Report the test statistic in context (when possible).</h3>
<p>The value of <span class="math inline">\(\chi^{2}\)</span> is 7.5010965.</p>
<p>Commentary: The <span class="math inline">\(\chi^{2}\)</span> test statistic is, of course, the same value we computed manually by hand earlier. Also, the formula for <span class="math inline">\(\chi^{2}\)</span> is a complicated function of observed and expected values, making it difficult to say anything about this number in the context of cars and engine cylinders. So even though the requirement is to “report the test statistic in context,” there’s not much one can say here other than just to report the test statistic.</p>
</section>
<section id="plot-the-null-distribution." class="level3" data-number="17.11.3">
<h3 data-number="17.11.3" class="anchored" data-anchor-id="plot-the-null-distribution."><span class="header-section-number">17.11.3</span> Plot the null distribution.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>cyl_test <span class="ot">&lt;-</span> mtcars <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> cyl_fct) <span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assume</span>(<span class="at">distribution =</span> <span class="st">"chisq"</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>cyl_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A Chi-squared distribution with 2 degrees of freedom.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>cyl_test <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visualize</span>() <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(obs_chisq, <span class="at">direction =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="17-chi_square_goodness_of_fit-web_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Commentary: We will use the theoretical distribution instead of the simulated distribution here. As long as the conditions are met, the use of the theoretical chi-squared sampling distribution is warranted.</p>
</section>
<section id="calculate-the-p-value." class="level3" data-number="17.11.4">
<h3 data-number="17.11.4" class="anchored" data-anchor-id="calculate-the-p-value."><span class="header-section-number">17.11.4</span> Calculate the P-value.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>cyl_test_p <span class="ot">&lt;-</span> cyl_test <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_p_value</span>(obs_chisq, <span class="at">direction =</span> <span class="st">"greater"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>cyl_test_p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["p_value"],"name":[1],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.02350486"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="interpret-the-p-value-as-a-probability-given-the-null." class="level3" data-number="17.11.5">
<h3 data-number="17.11.5" class="anchored" data-anchor-id="interpret-the-p-value-as-a-probability-given-the-null."><span class="header-section-number">17.11.5</span> Interpret the P-value as a probability given the null.</h3>
<p>The P-value is 0.0235049. If the true distribution of cars in 1974 were 38% 4-cylinder, 38% 6-cylinder, and 24% 8-cylinder, there would be a 2.3504856% chance of seeing data at least as extreme as what we saw.</p>
</section>
</section>
<section id="conclusion" class="level2" data-number="17.12">
<h2 data-number="17.12" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">17.12</span> Conclusion</h2>
<section id="state-the-statistical-conclusion." class="level3" data-number="17.12.1">
<h3 data-number="17.12.1" class="anchored" data-anchor-id="state-the-statistical-conclusion."><span class="header-section-number">17.12.1</span> State the statistical conclusion.</h3>
<p>We reject the null.</p>
</section>
<section id="state-but-do-not-overstate-a-contextually-meaningful-conclusion." class="level3" data-number="17.12.2">
<h3 data-number="17.12.2" class="anchored" data-anchor-id="state-but-do-not-overstate-a-contextually-meaningful-conclusion."><span class="header-section-number">17.12.2</span> State (but do not overstate) a contextually meaningful conclusion.</h3>
<p>There is sufficient evidence that in 1974, the distribution of cars was not 38% 4-cylinder, 38% 6-cylinder, and 24% 8-cylinder.</p>
</section>
<section id="express-reservations-or-uncertainty-about-the-generalizability-of-the-conclusion." class="level3" data-number="17.12.3">
<h3 data-number="17.12.3" class="anchored" data-anchor-id="express-reservations-or-uncertainty-about-the-generalizability-of-the-conclusion."><span class="header-section-number">17.12.3</span> Express reservations or uncertainty about the generalizability of the conclusion.</h3>
<p>As long as we restrict our attention to cars in 1974, we are pretty safe, although we are still uncertain if the sample we had was representative of all cars in 1974.</p>
</section>
<section id="identify-the-possibility-of-either-a-type-i-or-type-ii-error-and-state-what-making-such-an-error-means-in-the-context-of-the-hypotheses." class="level3" data-number="17.12.4">
<h3 data-number="17.12.4" class="anchored" data-anchor-id="identify-the-possibility-of-either-a-type-i-or-type-ii-error-and-state-what-making-such-an-error-means-in-the-context-of-the-hypotheses."><span class="header-section-number">17.12.4</span> Identify the possibility of either a Type I or Type II error and state what making such an error means in the context of the hypotheses.</h3>
<p>If we made a Type I error, that would mean the true distribution of cars in 1974 was 38% 4-cylinder, 38% 6-cylinder, and 24% 8-cylinder, but our sample showed otherwise.</p>
</section>
</section>
<section id="confidence-interval" class="level2" data-number="17.13">
<h2 data-number="17.13" class="anchored" data-anchor-id="confidence-interval"><span class="header-section-number">17.13</span> Confidence interval</h2>
<p>There is no confidence interval for a chi-square test. Since our test is not about measuring some parameter of interest (like <span class="math inline">\(p\)</span> or <span class="math inline">\(p_{1} - p_{2}\)</span>), there is no interval to produce.</p>
</section>
<section id="your-turn" class="level2" data-number="17.14">
<h2 data-number="17.14" class="anchored" data-anchor-id="your-turn"><span class="header-section-number">17.14</span> Your turn</h2>
<p>Use the <code>hsb2</code> data and determine if the proportion of high school students who attend general programs, academic programs, and vocational programs is 15%, 60%, and 25% respectively.</p>
<p>The rubric outline is reproduced below. You may refer to the worked example above and modify it accordingly. Remember to strip out all the commentary. That is just exposition for your benefit in understanding the steps, but is not meant to form part of the formal inference process.</p>
<p>Another word of warning: the copy/paste process is not a substitute for your brain. You will often need to modify more than just the names of the data frames and variables to adapt the worked examples to your own work. Do not blindly copy and paste code without understanding what it does. And you should <strong>never</strong> copy and paste text. All the sentences and paragraphs you write are expressions of your own analysis. They must reflect your own understanding of the inferential process.</p>
<p><strong>Also, so that your answers here don’t mess up the code chunks above, use new variable names everywhere.</strong></p>
<section id="exploratory-data-analysis-1" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exploratory-data-analysis-1">Exploratory data analysis</h5>
<section id="use-data-documentation-help-files-code-books-google-etc.-to-determine-as-much-as-possible-about-the-data-provenance-and-structure.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="use-data-documentation-help-files-code-books-google-etc.-to-determine-as-much-as-possible-about-the-data-provenance-and-structure.-1">Use data documentation (help files, code books, Google, etc.) to determine as much as possible about the data provenance and structure.</h6>
<div class="answer">
<p>Please write up your answer here</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to print the data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to glimpse the variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="prepare-the-data-for-analysis.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="prepare-the-data-for-analysis.-1">Prepare the data for analysis.</h6>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to prepare the data for analysis.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="make-tables-or-plots-to-explore-the-data-visually.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="make-tables-or-plots-to-explore-the-data-visually.-1">Make tables or plots to explore the data visually.</h6>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to make tables or plots.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
</section>
<section id="hypotheses-1" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="hypotheses-1">Hypotheses</h5>
<section id="identify-the-sample-or-samples-and-a-reasonable-population-or-populations-of-interest.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="identify-the-sample-or-samples-and-a-reasonable-population-or-populations-of-interest.-1">Identify the sample (or samples) and a reasonable population (or populations) of interest.</h6>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
<section id="express-the-null-and-alternative-hypotheses-as-contextually-meaningful-full-sentences.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="express-the-null-and-alternative-hypotheses-as-contextually-meaningful-full-sentences.-1">Express the null and alternative hypotheses as contextually meaningful full sentences.</h6>
<div class="answer">
<p><span class="math inline">\(H_{0}:\)</span> Null hypothesis goes here.</p>
<p><span class="math inline">\(H_{A}:\)</span> Alternative hypothesis goes here.</p>
</div>
</section>
<section id="express-the-null-and-alternative-hypotheses-in-symbols-when-possible.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="express-the-null-and-alternative-hypotheses-in-symbols-when-possible.-1">Express the null and alternative hypotheses in symbols (when possible).</h6>
<div class="answer">
<p><span class="math inline">\(H_{0}: math\)</span></p>
<p><span class="math inline">\(H_{A}: math\)</span></p>
</div>
</section>
</section>
<section id="model-1" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="model-1">Model</h5>
<section id="identify-the-sampling-distribution-model.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="identify-the-sampling-distribution-model.-1">Identify the sampling distribution model.</h6>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
<section id="check-the-relevant-conditions-to-ensure-that-model-assumptions-are-met.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="check-the-relevant-conditions-to-ensure-that-model-assumptions-are-met.-1">Check the relevant conditions to ensure that model assumptions are met.</h6>
<div class="answer">
<p>Please write up your answer here. (Some conditions may require R code as well.)</p>
</div>
</section>
</section>
<section id="mechanics-1" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="mechanics-1">Mechanics</h5>
<section id="compute-the-test-statistic.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="compute-the-test-statistic.-1">Compute the test statistic.</h6>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to compute the test statistic.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="report-the-test-statistic-in-context-when-possible.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="report-the-test-statistic-in-context-when-possible.-1">Report the test statistic in context (when possible).</h6>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
<section id="plot-the-null-distribution.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="plot-the-null-distribution.-1">Plot the null distribution.</h6>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to generate the null distribution.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to plot the null distribution.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="calculate-the-p-value.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="calculate-the-p-value.-1">Calculate the P-value.</h6>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to calculate the P-value.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="interpret-the-p-value-as-a-probability-given-the-null.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="interpret-the-p-value-as-a-probability-given-the-null.-1">Interpret the P-value as a probability given the null.</h6>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
</section>
<section id="conclusion-1" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="conclusion-1">Conclusion</h5>
<section id="state-the-statistical-conclusion.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="state-the-statistical-conclusion.-1">State the statistical conclusion.</h6>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
<section id="state-but-do-not-overstate-a-contextually-meaningful-conclusion.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="state-but-do-not-overstate-a-contextually-meaningful-conclusion.-1">State (but do not overstate) a contextually meaningful conclusion.</h6>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
<section id="express-reservations-or-uncertainty-about-the-generalizability-of-the-conclusion.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="express-reservations-or-uncertainty-about-the-generalizability-of-the-conclusion.-1">Express reservations or uncertainty about the generalizability of the conclusion.</h6>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
<section id="identify-the-possibility-of-either-a-type-i-or-type-ii-error-and-state-what-making-such-an-error-means-in-the-context-of-the-hypotheses.-1" class="level6 unnumbered">
<h6 class="unnumbered anchored" data-anchor-id="identify-the-possibility-of-either-a-type-i-or-type-ii-error-and-state-what-making-such-an-error-means-in-the-context-of-the-hypotheses.-1">Identify the possibility of either a Type I or Type II error and state what making such an error means in the context of the hypotheses.</h6>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
</section>
</section>
<section id="residuals" class="level2" data-number="17.15">
<h2 data-number="17.15" class="anchored" data-anchor-id="residuals"><span class="header-section-number">17.15</span> Residuals</h2>
<p>The chi-square test can tell us if there is some difference from the expected distribution of counts across the categories, but it doesn’t tell us which category has a higher or lower count than expected. For that, we’ll need to turn to another tool: <em>residuals</em>. For technical reasons, the <code>infer</code> package doesn’t provide residuals, so we’ll have to turn to slightly different tools. Here’s how this works; we’ll return to the example of distribution of cars across the different categories of number of cylinders.</p>
<p>The function we’ll use is <code>chisq.test</code> as we saw before. It requires us to give it input in the form of a table of counts, together with the proportions we wish to compare to:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mtcars<span class="sc">$</span>cyl_fct) <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chisq.test</span>(<span class="at">p =</span> <span class="fu">c</span>(.<span class="dv">38</span>, .<span class="dv">38</span>, .<span class="dv">24</span>)) <span class="ot">-&gt;</span> cyl_chisq.test</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>cyl_chisq.test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  table(mtcars$cyl_fct)
X-squared = 7.5011, df = 2, p-value = 0.0235</code></pre>
</div>
</div>
<p>Notice that the chi-squared value 7.5011 and the p-value 0.0235 are the same as those we calculated using <code>infer</code> tools above.</p>
<p>Here’s how to obtain the table of residuals:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>cyl_chisq.test<span class="sc">$</span>residuals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
         4          6          8 
-0.3326528 -1.4797315  2.2805336 </code></pre>
</div>
</div>
<p>What do these numbers mean in the real world? Not much. (Essentially, they are the values that were squared to become the individual cell contributions to the overall chi-squared score of the table.)</p>
<p>What we’ll do with them is look for the most positive and most negative values.</p>
<ul>
<li>We see that the 8-cylinder column has the most positive value: this means that the number of 8-cylinder cars in 1974 was substantially <em>higher</em> than we expected.</li>
<li>We see that the 6-cylinder column has the most negative value: this means that the number of 6-cylinder cars in 1974 was substantially <em>lower</em> than we expected.</li>
</ul>
</section>
<section id="your-turn-1" class="level2" data-number="17.16">
<h2 data-number="17.16" class="anchored" data-anchor-id="your-turn-1"><span class="header-section-number">17.16</span> Your turn</h2>
<p>Determine which of the high school program types is the most substantially overrepresented and the most substantially underrepresented, according to our hypothesized distribution.</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to produce the chisq.test result.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to examine the residuals.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Please write your answer here.</p>
</div>
</section>
<section id="conclusion-2" class="level2" data-number="17.17">
<h2 data-number="17.17" class="anchored" data-anchor-id="conclusion-2"><span class="header-section-number">17.17</span> Conclusion</h2>
<p>When a categorical variable has three or more categories, we can run a chi-square goodness-of-fit test to determine if the distribution of counts across those categories matches some pre-specified null hypothesis. The key new mathematical tool we need is the chi-square distribution, a way of measuring the deviation between observed counts and expected counts according to the null.</p>
<section id="preparing-and-submitting-your-assignment" class="level3" data-number="17.17.1">
<h3 data-number="17.17.1" class="anchored" data-anchor-id="preparing-and-submitting-your-assignment"><span class="header-section-number">17.17.1</span> Preparing and submitting your assignment</h3>
<ol type="1">
<li>From the “Run” menu, select “Restart R and Run All Chunks”.</li>
<li>Deal with any code errors that crop up. Repeat steps 1–2 until there are no more code errors.</li>
<li>Spell check your document by clicking the icon with “ABC” and a check mark.</li>
<li>Hit the “Render” button one last time to generate the final draft of the HTML file. (If there are errors here, you may need to go back and fix broken inline code or other markdown issues.)</li>
<li>Proofread the HTML file carefully. If there are errors, go back and fix them, then repeat steps 1–5 again.</li>
</ol>
<p>If you have completed this chapter as part of a statistics course, follow the directions you receive from your professor to submit your assignment.</p>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Rhyming is fun!<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./16-inference_for_two_proportions-web.html" class="pagination-link" aria-label="Inference for two proportions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Inference for two proportions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./18-chi_square_test_for_independence-web.html" class="pagination-link" aria-label="Chi-square test for independence">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Chi-square test for independence</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/VectorPosse/intro_stats/edit/main/17-chi_square_goodness_of_fit-web.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/VectorPosse/intro_stats/issues" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>