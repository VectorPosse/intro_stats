<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Categorical data – Introduction to Statistics: an integrated textbook and workbook using R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-numerical_data-web.html" rel="next">
<link href="./02-using_quarto-web.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c1f47e0d63438896ca427a756e834e96.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-categorical_data-web.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Categorical data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Statistics: an integrated textbook and workbook using R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/VectorPosse/intro_stats" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro_to_r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-using_quarto-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Using Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-categorical_data-web.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Categorical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-numerical_data-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Numerical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-manipulating_data-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulating data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-correlation-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Correlation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-regression-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-intro_to_randomization_1-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to randomization, Part 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-intro_to_randomization_2-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to randomization, Part 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-hypothesis_testing_with_randomization_1-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Hypothesis testing with randomization, Part 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-hypothesis_testing_with_randomization_2-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesis testing with randomization, Part 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-confidence_intervals-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Confidence intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-normal_models-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Normal models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-sampling_distribution_models-web.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Sampling distribution models</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Rubric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Rubric for inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Concordance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Concordance with <em>Introduction to Modern Statistics</em> (IMS)</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">3.1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#install-new-packages" id="toc-install-new-packages" class="nav-link" data-scroll-target="#install-new-packages"><span class="header-section-number">3.1.1</span> Install new packages</a></li>
  <li><a href="#download-the-quarto-file" id="toc-download-the-quarto-file" class="nav-link" data-scroll-target="#download-the-quarto-file"><span class="header-section-number">3.1.2</span> Download the Quarto file</a></li>
  <li><a href="#restart-r-and-run-all-chunks" id="toc-restart-r-and-run-all-chunks" class="nav-link" data-scroll-target="#restart-r-and-run-all-chunks"><span class="header-section-number">3.1.3</span> Restart R and run all chunks</a></li>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages"><span class="header-section-number">3.1.4</span> Load packages</a></li>
  </ul></li>
  <li><a href="#categorical-data" id="toc-categorical-data" class="nav-link" data-scroll-target="#categorical-data"><span class="header-section-number">3.2</span> Categorical data</a></li>
  <li><a href="#factor-variables" id="toc-factor-variables" class="nav-link" data-scroll-target="#factor-variables"><span class="header-section-number">3.3</span> Factor variables</a></li>
  <li><a href="#summarizing-one-categorical-variable" id="toc-summarizing-one-categorical-variable" class="nav-link" data-scroll-target="#summarizing-one-categorical-variable"><span class="header-section-number">3.4</span> Summarizing one categorical variable</a></li>
  <li><a href="#graphing-one-categorical-variable" id="toc-graphing-one-categorical-variable" class="nav-link" data-scroll-target="#graphing-one-categorical-variable"><span class="header-section-number">3.5</span> Graphing one categorical variable</a>
  <ul class="collapse">
  <li><a href="#ggplot" id="toc-ggplot" class="nav-link" data-scroll-target="#ggplot"><span class="header-section-number">3.5.1</span> ggplot</a></li>
  </ul></li>
  <li><a href="#summarizing-two-categorical-variables" id="toc-summarizing-two-categorical-variables" class="nav-link" data-scroll-target="#summarizing-two-categorical-variables"><span class="header-section-number">3.6</span> Summarizing two categorical variables</a></li>
  <li><a href="#graphing-two-categorical-variables" id="toc-graphing-two-categorical-variables" class="nav-link" data-scroll-target="#graphing-two-categorical-variables"><span class="header-section-number">3.7</span> Graphing two categorical variables</a></li>
  <li><a href="#recoding-factor-variables" id="toc-recoding-factor-variables" class="nav-link" data-scroll-target="#recoding-factor-variables"><span class="header-section-number">3.8</span> Recoding factor variables</a></li>
  <li><a href="#plotting-summary-data" id="toc-plotting-summary-data" class="nav-link" data-scroll-target="#plotting-summary-data"><span class="header-section-number">3.9</span> Plotting summary data</a></li>
  <li><a href="#recovering-raw-data-from-tables" id="toc-recovering-raw-data-from-tables" class="nav-link" data-scroll-target="#recovering-raw-data-from-tables"><span class="header-section-number">3.10</span> Recovering raw data from tables</a>
  <ul class="collapse">
  <li><a href="#recovering-raw-data-from-a-frequency-table" id="toc-recovering-raw-data-from-a-frequency-table" class="nav-link" data-scroll-target="#recovering-raw-data-from-a-frequency-table"><span class="header-section-number">3.10.1</span> Recovering raw data from a frequency table</a></li>
  <li><a href="#recovering-raw-data-from-a-contingency-table" id="toc-recovering-raw-data-from-a-contingency-table" class="nav-link" data-scroll-target="#recovering-raw-data-from-a-contingency-table"><span class="header-section-number">3.10.2</span> Recovering raw data from a contingency table</a></li>
  </ul></li>
  <li><a href="#publication-ready-graphics" id="toc-publication-ready-graphics" class="nav-link" data-scroll-target="#publication-ready-graphics"><span class="header-section-number">3.11</span> Publication-ready graphics</a>
  <ul class="collapse">
  <li><a href="#using-colorblind-friendly-palettes" id="toc-using-colorblind-friendly-palettes" class="nav-link" data-scroll-target="#using-colorblind-friendly-palettes"><span class="header-section-number">3.11.1</span> Using colorblind-friendly palettes</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">3.12</span> Conclusion</a>
  <ul class="collapse">
  <li><a href="#preparing-and-submitting-your-assignment" id="toc-preparing-and-submitting-your-assignment" class="nav-link" data-scroll-target="#preparing-and-submitting-your-assignment"><span class="header-section-number">3.12.1</span> Preparing and submitting your assignment</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/VectorPosse/intro_stats/edit/main/03-categorical_data-web.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/VectorPosse/intro_stats/issues" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Categorical data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Functions introduced in this chapter
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>glimpse</code>, <code>table</code>, <code>tabyl</code>, <code>adorn_totals</code>, <code>adorn_pct_formatting</code>, <code>ggplot</code>, <code>geom_bar</code>, <code>adorn_percentages</code>, <code>mutate</code>, <code>as_factor</code>, <code>tibble</code>, <code>geom_col</code>, <code>uncount</code>, <code>pivot_longer</code>, <code>-&gt;</code>, <code>labs</code>, <code>scale_fill_viridis_d</code>, <code>scale_fill_grey</code>, <code>theme_bw</code></p>
</div>
</div>
<section id="introduction" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">3.1</span> Introduction</h2>
<p>In this chapter, we’ll learn about categorical data and how to summarize it using tables and graphs.</p>
<section id="install-new-packages" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="install-new-packages"><span class="header-section-number">3.1.1</span> Install new packages</h3>
<p>Type the following at the Console:</p>
<pre><code>install.packages("janitor")</code></pre>
</section>
<section id="download-the-quarto-file" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="download-the-quarto-file"><span class="header-section-number">3.1.2</span> Download the Quarto file</h3>
<p>Look at either the top (Posit Cloud) or the upper right corner of the RStudio screen to make sure you are in your <code>intro_stats</code> project.</p>
<p>Then click on the following link to download this chapter as a Quarto file (<code>.qmd</code>).</p>
<p><a href="https://vectorposse.github.io/intro_stats/chapter_downloads/03-categorical_data.qmd" download="">https://vectorposse.github.io/intro_stats/chapter_downloads/03-categorical_data.qmd</a></p>
<p>Once the file is downloaded, move it to your project folder in RStudio and open it there.</p>
</section>
<section id="restart-r-and-run-all-chunks" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="restart-r-and-run-all-chunks"><span class="header-section-number">3.1.3</span> Restart R and run all chunks</h3>
<p>In RStudio, in the toolbar above this document, find the “Run” drop-down menu and select “Restart R and Run All Chunks.”</p>
<p>This does two important things:</p>
<ol type="1">
<li>R will restart. This will clear out the Global Environment and provide a fresh session for this new assignment. None of the clutter from previous chapters will be there to mess up your work in this chapter.</li>
<li>All the code chunks in this document will run so that you can see the output as you scroll past it. This saves you some effort in having to click the little green “Run” button in each code chunk as you come across it. (Also, if you forget to run one, that could cause errors later on, so this way, all the variables you need will be in the Global Environment for when they’re needed later.) You will still need to click the green arrow for new code chunks that you create, of course.</li>
</ol>
<p>At the end of the assignment, you will “Restart R and Run All Chunks” once again to make sure that everything works smoothly and there are no lingering errors.</p>
</section>
<section id="load-packages" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="load-packages"><span class="header-section-number">3.1.4</span> Load packages</h3>
<p>We load the <code>tidyverse</code> package since it also loads the <code>ggplot2</code> package that we’ll use throughout the course to make graphs. It also loads several other packages, for example, one called <code>dplyr</code> to give us a command called <code>mutate</code>, and another called <code>forcats</code> to give us <code>as_factor</code>. (These will all be explained later.) The <code>janitor</code> package gives us the <code>tabyl</code> command for creating nice tables. Finally, We load the <code>palmerpenguins</code> package to work with the penguin data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'

The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="categorical-data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="categorical-data"><span class="header-section-number">3.2</span> Categorical data</h2>
<p>Data comes in different types depending on what is being measured. When people think of “data”, they often imagine <em>numerical data</em>, consisting of numbers. But there are other kinds of data as well.</p>
<p>In this chapter, we focus on <em>categorical data</em> that groups observations into categories.</p>
<p>For example, if we record the species of a penguin, that is not a number. It’s a word that classifies that penguin into one of a finite number of types. Whenever you see words in a data set, there’s a good chance that you’re looking at categorical data.</p>
<p>Even “numbers” can sometimes represent categorical data. For example, suppose in a survey there is a Yes/No question. Instead of seeing the words “Yes” or “No”, though, you might see a data set with ones and zeros, where 1 = Yes and 0 = No.&nbsp;The presence of numbers does not automatically make that data numerical. In fact, the data is categorical. Yes and No are categories that sort the survey respondents into two groups based on their responses to a certain question.</p>
<p>What about ZIP codes? They are recorded as numbers, and unlike the Yes/No example above, those numbers aren’t just substitutes for words. Nevertheless, ZIP codes are categorical. They sort addresses into a finite number of groups based on geographic proximity.</p>
<p>Another way to think of it is this: can the numerical values of ZIP codes be treated as numbers in any meaningful way? Can you take a sum or an average of ZIP codes? Sure, technically a computer can add up or average a set of ZIP codes, but would the result be a meaningful number? Since the answer is “no” we cannot think of ZIP codes as numbers, even though they are recorded that way.</p>
<section id="exercise-1" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-1">Exercise 1</h5>
<p>Think of another type of data that would be recorded using numbers but should be thought of as categorical data.</p>
<p>(Recall from the last chapter that you will record your answers to exercises within an answer block like the one below, demarcated with three colons at both ends. Be VERY careful not mess with these three-colon “tags” or with the code <code>{.answer}</code>. If this code gets messed up, it’s likely that your document will not render. Instead, you will delete the words “Please write up your answer here” and replace them with your answer.)</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
</section>
<section id="factor-variables" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="factor-variables"><span class="header-section-number">3.3</span> Factor variables</h2>
<p>R uses the term “factor variable” to refer to a categorical variable. Look at the structure of the <code>penguins</code> data below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [344 × 8] (S3: tbl_df/tbl/data.frame)
 $ species          : Factor w/ 3 levels "Adelie","Chinstrap",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ island           : Factor w/ 3 levels "Biscoe","Dream",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...
 $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...
 $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...
 $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...
 $ sex              : Factor w/ 2 levels "female","male": 2 1 1 NA 1 2 1 2 NA NA ...
 $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...</code></pre>
</div>
</div>
<p>The categorical variables <code>species</code>, <code>island</code>, and <code>sex</code> are coded correctly as factor variables.</p>
<p>The <code>tidyverse</code> package offers a function called <code>glimpse</code> that effectively does the same thing as <code>str</code>. We’ll use <code>glimpse</code> throughout the rest of the course.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
$ island            &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …
$ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …
$ sex               &lt;fct&gt; male, female, female, NA, female, male, female, male…
$ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</code></pre>
</div>
</div>
<section id="exercise-2" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-2">Exercise 2</h5>
<p>Look at the output of <code>str</code> versus <code>glimpse</code> above. Write down any advantages or disadvantages you see using one versus the other. (You may also want to check the help file for the two commands to see if they offer any clues as to why you might use one over the other.)</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>Your data set may already come with its variables coded correctly as factor variables, but often they are not. As described above, numbers are often used to represent categories, so R may think that those variables represent numerical data. Later, we’ll see an example of this and learn how to handle categorical variables that are not coded as factor variables in R.</p>
</section>
</section>
<section id="summarizing-one-categorical-variable" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="summarizing-one-categorical-variable"><span class="header-section-number">3.4</span> Summarizing one categorical variable</h2>
<p>If you need to summarize a single categorical variable, a <em>frequency table</em> usually suffices. This is simply a table that counts up all the instances of each category. The word “frequency” is synonymous here with the word “count”.</p>
<p>We can use the <code>table</code> command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(penguins<span class="sc">$</span>species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   Adelie Chinstrap    Gentoo 
      152        68       124 </code></pre>
</div>
</div>
<p>Recall that the dollar sign means to grab the variable <code>species</code> from the tibble <code>penguins</code>.</p>
<p>You can also generate a <em>relative frequency table</em> which is a table that uses proportions or percentages instead of counts.</p>
<p><strong>NOTE:</strong> For purposes of this course, we’re going to be very careful about the terms <em>proportion</em> and <em>percentage</em>. For us, a proportion will always be a number between 0 and 1 whereas a percentage will be between 0 and 100. Calculating a percentage is the same as multiplying a proportion by 100.</p>
<p>The <code>table</code> command stops being convenient if you want proportions instead of counts. Instead, we will use the <code>tabyl</code> command from the <code>janitor</code> package that was loaded near the top of the chapter. The syntax for this command is a little different. The tibble goes first, followed by a comma, followed by the variable you want to summarize:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(penguins, species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["species"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Adelie","2":"152","3":"0.4418605"},{"1":"Chinstrap","2":"68","3":"0.1976744"},{"1":"Gentoo","2":"124","3":"0.3604651"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now you get both counts and proportions. Note that in the output above, it’s a little misleading to call the last column “percent”. These are actually proportions, and we would have to multiply by 100 to get percentages.</p>
<p>It’s usually nice to have the column totals. We can achieve that by using an <code>adorn</code> function to get them as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(penguins, species) <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["species"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Adelie","2":"152","3":"0.4418605","_rn_":"1"},{"1":"Chinstrap","2":"68","3":"0.1976744","_rn_":"2"},{"1":"Gentoo","2":"124","3":"0.3604651","_rn_":"3"},{"1":"Total","2":"344","3":"1.0000000","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We’ll always include the totals at the bottom.</p>
<p>If you really want percentages, we can use a different <code>adorn</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(penguins, species) <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["species"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["percent"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Adelie","2":"152","3":"44.2%"},{"1":"Chinstrap","2":"68","3":"19.8%"},{"1":"Gentoo","2":"124","3":"36.0%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Again, we’ll also include <code>adorn_totals</code> so that we get the column totals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(penguins, species) <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["species"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["percent"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Adelie","2":"152","3":"44.2%","_rn_":"1"},{"1":"Chinstrap","2":"68","3":"19.8%","_rn_":"2"},{"1":"Gentoo","2":"124","3":"36.0%","_rn_":"3"},{"1":"Total","2":"344","3":"100.0%","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The syntax above looks a little confusing with the unusual <code>|&gt;</code> symbols everywhere. You will learn more about that weird set of symbols in a later chapter. For now, you can just copy and paste this code and make any necessary changes to the tibble and/or variables names as needed.</p>
<section id="exercise-3a" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-3a">Exercise 3(a)</h5>
<p>Use the <code>tabyl</code> command as above to create a frequency table for the sex of the penguins. Include the column totals at the bottom. (You will also get a relative frequency table for free.)</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to create a frequency table for sex</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="exercise-3b" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-3b">Exercise 3(b)</h5>
<p>In the table for sex that you just created, what does the row labeled <code>&lt;NA&gt;</code> mean?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
<section id="exercise-3c" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-3c">Exercise 3(c)</h5>
<p>Now create a relative frequency table for sex that reports percentages and not proportions (still including the column totals at the bottom).</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here that reports percentages instead of proportions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="exercise-3d" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-3d">Exercise 3(d)</h5>
<p>In the previous tables, what is the difference between <code>percent</code> and <code>valid_percent</code>? Why are there two different sets of percentages being computed?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
</section>
<section id="graphing-one-categorical-variable" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="graphing-one-categorical-variable"><span class="header-section-number">3.5</span> Graphing one categorical variable</h2>
<p>When asked, “What type of graph should I use when graphing a single categorical variable?” the simple answer is “None.” If you do need to summarize a categorical variable, a frequency table usually suffices.</p>
<p>If you really, really want a graph, the standard type is a bar chart. But before we can create one, we need to start learning about the very important tool we will use throughout the course for graphing. It’s called <code>ggplot</code> and it’s part of a package called <code>ggplot2</code>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>We don’t have to load the <code>ggplot2</code> package explicitly because it got loaded alongside a number of other packages when we called <code>library(tidyverse)</code> early on in the chapter.</p>
<section id="ggplot" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="ggplot"><span class="header-section-number">3.5.1</span> ggplot</h3>
<p>The <code>ggplot</code> command is an all-purpose graphing utility. It uses a graphing philosophy derived from a book called <em>The Grammar of Graphics</em> by Leland Wilkinson. The basic idea is that each variable you want to plot should correspond to some element or “aesthetic” component of the graph. The obvious places for data to go are along the y-axis or x-axis, but other aesthetics are important too; graphs often use color, shape, or size to illustrate different aspects of data. Once these aesthetics have been defined, we will add “layers” to the graph. These are objects like dots, boxes, lines, or bars that dictate the type of graph we want to see.</p>
<p>In an introductory course, we won’t get too fancy with these graphs. But be aware that there’s a whole field of data visualization that studies clear and interesting ways to understand data graphically.</p>
<p>It will be easier to explain the <code>ggplot</code> syntax in the context of specific graph types, so let’s create a bar chart for species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We’ll walk through this syntax step by step.</p>
<ul>
<li>The first argument of the <code>ggplot</code> command is the name of the tibble, in this case, <code>penguins</code>.</li>
<li>Next we define the aesthetics using <code>aes</code> and parentheses. Inside the parentheses, we assign any variables we want to plot to aesthetics of the graph. For this analysis, we are only interested in the variable <code>species</code> and for a bar chart, the categorical variable typically goes on the x-axis. That’s why it says <code>x = species</code> inside the <code>aes</code> argument.</li>
<li>Finally, <code>ggplot</code> needs to know what kind of graph we want. Graph types are called “geoms” in the <code>ggplot</code> world, and <code>geom_bar()</code> tells <code>ggplot</code> to add a “bar chart layer”. Adding a layer is accomplished by literally typing a plus sign.</li>
</ul>
<p>This can be modified somewhat to give proportions (relative frequencies) on the y-axis instead of counts. Unfortunately, the <code>ggplot</code> syntax is not very transparent here. My recommendation is to copy and paste the code below if you need to make a relative frequency bar chart in the future, making the necessary changes to the tibble and variable names, of course.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> <span class="fu">after_stat</span>(prop), <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These bar charts are the graphical analogues of a frequency table and a relative frequency table, respectively.</p>
<section id="exercise-4" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-4">Exercise 4</h5>
<p>In a sentence or two at most, describe the distribution of species in this data set.</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>What about pie charts? Just. Don’t.</p>
<p>Seriously. Pie charts suck: <a href="https://medium.com/the-mission/to-pie-charts-3b1f57bcb34a">https://medium.com/the-mission/to-pie-charts-3b1f57bcb34a</a></p>
<p>Okay, in fairness, here is the opinion of one data visualization researcher who gives a (somewhat qualified) defense of pie charts (in certain narrow situations): <a href="https://eagereyes.org/pie-charts">https://eagereyes.org/pie-charts</a></p>
<p>We will not be creating any pie charts in this course.</p>
</section>
</section>
</section>
<section id="summarizing-two-categorical-variables" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="summarizing-two-categorical-variables"><span class="header-section-number">3.6</span> Summarizing two categorical variables</h2>
<p>A table summarizing two categorical variables is called a <em>contingency table</em> (or pivot table, or cross-tabulation, or probably several other terms as well).</p>
<p>For example, we might pose the following question: is the distribution of sex among penguins in our data more or less balanced across the three species?</p>
<p>When we work with two variables, typically we think of one variable as <em>response</em> and the other as <em>predictor</em>. The response variable is usually the variable of main interest. A predictor variable is another attribute that might predict or explain more about the response variable. Often, the predictor variable is used to divide our data into groups for comparison.</p>
<p>For example, our question is concerned with the sex distribution of penguins. We could create a relative frequency table of sex alone to see if male and female penguins are balanced in the data. In fact, you did that very thing above and saw that, indeed, there were roughly equal numbers of male and female penguins. But is that still true when we divide up the data into the three groups representing the separate species?</p>
<p>Two variables are called <em>associated</em> when there is a relationship between them. For example, if sex and species were associated, then the distribution of sex would change depending on the species. Maybe one species of penguin had more females and another had fewer females available to the researchers who compiled this data. Our prediction of the sex distribution would change based on the value of the predictor (grouping) variable <code>species</code>.</p>
<p>On the other hand, two variables that are not associated are called <em>independent</em>. Independent variables are not related. If the sex distribution were the same across all species, then knowledge of the species would not change our predictions about the sex of a penguin. It wouldn’t matter because there was no relationship between sex and species.</p>
<p>Most research questions that involve two or more variables are fundamentally questions of whether a response variable is associated with one or more predictor variables, or whether they are independent.</p>
<p>Let’s look at a contingency table. The <code>tabyl</code> command will place the first variable listed across the rows and the second one listed down the columns. Since we always include column totals, we want the predictor variable to be the column variable so we can see how the predictor groups are distributed in the data. <strong>Always list the response variable first</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(penguins, sex, species) <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["sex"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Adelie"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Chinstrap"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Gentoo"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"73","3":"34","4":"58","_rn_":"1"},{"1":"male","2":"73","3":"34","4":"61","_rn_":"2"},{"1":"NA","2":"6","3":"0","4":"5","_rn_":"3"},{"1":"Total","2":"152","3":"68","4":"124","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Each column is a group, and our question is whether the distribution of sexes in each column is similar.</p>
<p>The last row of totals is called the <em>marginal distribution</em> (because it sits in the “margin” of the contingency table). It is equivalent to a frequency table for <code>species</code>.</p>
<section id="exercise-5" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-5">Exercise 5</h5>
<p>Counts can be misleading. For example, there are 73 female Adelie penguins, but only 34 female Chinstrap penguins. Does that mean that Adelie penguins are more likely to be female than Chinstrap penguins? Why or why not?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>A more fair way to compare across columns is to create relative frequencies. We can do this with a slightly different <code>adorn</code> command. The following code says that we want to compute column proportions (yes, I know the command is called <code>adorn_percentages</code>, but these are proportions):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(penguins, sex, species) <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>(<span class="st">"col"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["sex"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Adelie"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Chinstrap"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Gentoo"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"0.48026316","3":"0.5","4":"0.46774194","_rn_":"1"},{"1":"male","2":"0.48026316","3":"0.5","4":"0.49193548","_rn_":"2"},{"1":"NA","2":"0.03947368","3":"0.0","4":"0.04032258","_rn_":"3"},{"1":"Total","2":"1.00000000","3":"1.0","4":"1.00000000","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>It’s important to put “col” inside the <code>adorn_percentages</code> command. Look what happens if we forget:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We should not do this!</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(penguins, sex, species) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["sex"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Adelie"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Chinstrap"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Gentoo"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"0.4424242","3":"0.2060606","4":"0.3515152","_rn_":"1"},{"1":"male","2":"0.4345238","3":"0.2023810","4":"0.3630952","_rn_":"2"},{"1":"NA","2":"0.5454545","3":"0.0000000","4":"0.4545455","_rn_":"3"},{"1":"Total","2":"0.4418605","3":"0.1976744","4":"0.3604651","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>What are these proportions? The next code chunk will reveal the secret:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We should not do this!</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(penguins, sex, species) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>(<span class="st">"row"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["sex"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Adelie"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Chinstrap"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Gentoo"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"0.4424242","3":"0.2060606","4":"0.3515152","_rn_":"1"},{"1":"male","2":"0.4345238","3":"0.2023810","4":"0.3630952","_rn_":"2"},{"1":"NA","2":"0.5454545","3":"0.0000000","4":"0.4545455","_rn_":"3"},{"1":"Total","2":"0.4418605","3":"0.1976744","4":"0.3604651","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The default for <code>adorn_percentages</code> is to create row proportions. But these are not helpful to us. We are not grouping by sex and then trying to figure out the distribution of species within each sex. It’s the opposite of our research question.</p>
<p>If we actually want percentages instead of proportions, we need one more line of code. This command—<code>adorn_pct_formatting</code>—is the same as we used before with frequency tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(penguins, sex, species) <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>(<span class="st">"col"</span>) <span class="sc">|&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_pct_formatting</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["sex"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Adelie"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Chinstrap"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Gentoo"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"female","2":"48.0%","3":"50.0%","4":"46.8%","_rn_":"1"},{"1":"male","2":"48.0%","3":"50.0%","4":"49.2%","_rn_":"2"},{"1":"NA","2":"3.9%","3":"0.0%","4":"4.0%","_rn_":"3"},{"1":"Total","2":"100.0%","3":"100.0%","4":"100.0%","_rn_":"4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now we can see that each column adds up to 100%. In other words, each species is now on equal footing, and only the distribution of sexes within each group matters.</p>
</section>
<section id="exercise-6a" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-6a">Exercise 6(a)</h5>
<p>What percentage of Adelie penguins are male? What percentage of Chinstrap penguins are male? What percentage of Gentoo penguins are male?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
<section id="exercise-6b" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-6b">Exercise 6(b)</h5>
<p>Does sex appear to be associated with species for the penguins in this data set? Or are these variables independent? Why?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>The islands of Antarctica on which the penguins were observed and measured are recorded in the variable called <code>island</code>. Is the distribution of the three species of penguin the same (or similar) on the three islands?</p>
</section>
<section id="exercise-7a" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-7a">Exercise 7(a)</h5>
<p>Choosing which variables play the roles of response and predictor can be tricky. For the question above, with <code>species</code> and <code>island</code>, which is response and which is predictor?</p>
<p>One way to think about this is to ask the following two questions and see which one is closer to the question asked:</p>
<ul>
<li>Given information about the species, are you interested in which island the penguin lives on? If so, <code>species</code> is a predictor and <code>island</code> is response. (You are using <code>species</code> to predict <code>island</code>.)</li>
<li>Given information about the island, are you interested in the species of the penguin? If so, <code>island</code> is a predictor and <code>species</code> is response. (You are using <code>island</code> to predict <code>species</code>.)</li>
</ul>
<p>Another way to think of this is to determine the grouping variable. Which variable is being used to divide the penguins into groups first? That will be the predictor variable.</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
<section id="exercise-7b" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-7b">Exercise 7(b)</h5>
<p>Create a contingency table with percentages. List <code>species</code> first, followed by <code>island</code>. (Hey, that’s a hint in case you need to go back and change your answer to part (a).) Include column totals as well. (They should all be 100%.)</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to create a contingency table with percentages.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="exercise-7c" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-7c">Exercise 7(c)</h5>
<p>Finally, comment on the association or independence of the two variables.</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
</section>
<section id="graphing-two-categorical-variables" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="graphing-two-categorical-variables"><span class="header-section-number">3.7</span> Graphing two categorical variables</h2>
<p>A somewhat effective way to display two categorical variables is with a side-by-side bar chart. Here is the <code>ggplot</code> code for the relationship between <code>sex</code> and <code>species</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">fill =</span> sex, <span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is somewhat different from the first <code>ggplot</code> example you saw above, so let’s take a moment to go through it.</p>
<ul>
<li>The first argument is the data frame <code>penguins</code>; no mystery there.</li>
<li>The second aesthetic <code>x = species</code> also makes a lot of sense. As <code>species</code> is our predictor variable—we’re using species to group the penguins, and then within each species, we’re interested in the sex distribution—<code>species</code> goes on the x-axis.</li>
<li>However, <code>sex</code> does not go on the y-axis! (This is a very common mistake for novices.) The y-axis of a bar chart is always a count or a proportion/percentage, so no variable should ever go on the y-axis of a bar chart. In that case, how does <code>sex</code> enter the picture? Through the use of color! The aesthetic <code>fill = sex</code> says to use the <code>sex</code> variable to shade or “fill” the bars with different colors. You’ll also notice that <code>ggplot</code> makes a legend automatically with the colors so you can see which color corresponds to which value (in this case, “female”, “male”, or “NA” for the missing data).</li>
</ul>
<p>Another unusual feature is the argument <code>position = "dodge"</code> in the <code>geom_bar</code> layer. Let’s see what happens if we remove it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">fill =</span> sex, <span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We get a stacked bar chart! This is another popular way of displaying two categorical variables, but we don’t tend to prefer it. Notice how difficult it is to compare the number of females across species; since there is no common baseline for the red segments of each bar, it is harder to determine which ones are bigger or smaller. (In this case, it’s fairly clear, but there are plenty of data sets for which the counts might be a lot closer.)</p>
<p>So let’s agree to use side-by-side bar charts. There is still one aspect of the side-by-side bar chart that is misleading, though. For example, the red bar for Adelie penguins is bigger than the red bar for Gentoo penguins. Does this mean Adelie penguins are more likely to be female?</p>
<p>This is the same issue we identified in an exercise above. To fix this problem, a better option here would be to use relative frequencies (i.e., proportions/percentages within each group) instead of counts on the y-axis. This is analogous to using proportions/percentages in a contingency table. Unfortunately, it is rather difficult to do this with <code>ggplot</code>. A compromise is available: by using <code>position = fill</code>, you can create a stacked bar chart that scales every group to 100%. Making comparisons across groups can still be hard, as explained above for any kind of stacked bar chart, but it works okay if there are only two categories in the response variable (as is almost the case with <code>sex</code> here, although the missing data distorts things a little at the bottom).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">fill =</span> sex, <span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This graph does correctly show that the sexes are pretty much equally balanced across all three species.</p>
<section id="exercise-8a" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-8a">Exercise 8(a)</h5>
<p>Using <code>species</code> and <code>island</code>, create a side-by-side bar chart. Be careful, though, to change the sample code above to make sure <code>species</code> is now the response variable (using the <code>fill</code> aesthetic) and that <code>island</code> is the explanatory variable (using <code>x</code>). (Hey, that’s another hint to go back and look at the previous exercise and make sure you got part (a) right!)</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to make a side-by-side bar chart.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="exercise-8b" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-8b">Exercise 8(b)</h5>
<p>Comment on the association or independence of the two variables.</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
</section>
<section id="recoding-factor-variables" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="recoding-factor-variables"><span class="header-section-number">3.8</span> Recoding factor variables</h2>
<p>As mentioned earlier, there are situations where a categorical variable is not recorded in R as a factor variable. Let’s look at the <code>year</code> variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(penguins<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...</code></pre>
</div>
</div>
<p>These appear as integers. Yes, years are whole numbers, but why might this variable be treated as categorical data and not numerical data?</p>
<section id="exercise-9a" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-9a">Exercise 9(a)</h5>
<p>Use the <code>tabyl</code> command to create a frequency table for <code>year</code>.</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to make a frequency table for year.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="exercise-9b" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-9b">Exercise 9(b)</h5>
<p>Why is <code>year</code> better thought of as categorical data and not numerical data (at least for this data set—we’re not claiming years should always be treated as categorical)?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>While the <code>tabyl</code> command seemed to work just fine with the <code>year</code> data in integer format, there are other commands that will not work so well. For example, <code>ggplot</code> often fails to do the right thing when a categorical variable is coded as a number. Therefore, we need a way to change numerically coded variables to factors.</p>
<p>The code below uses a command called <code>mutate</code> that takes an old variable and creates a new variable. (You’ll learn more about this command in a later chapter. For now, you can just copy and paste this code if you need it again.) The name of the new variable can be anything we want; we’ll just call it <code>year_fct</code>. Then the real work is being done by the <code>as_factor</code> command that converts the numeric <code>year</code> variable into a factor variable.</p>
<p>Observe the effect below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year_fct =</span> <span class="fu">as_factor</span>(year))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 9
$ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
$ island            &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …
$ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …
$ sex               &lt;fct&gt; male, female, female, NA, female, male, female, male…
$ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…
$ year_fct          &lt;fct&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</code></pre>
</div>
</div>
</section>
<section id="exercise-10a" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-10a">Exercise 10(a)</h5>
<p>Make a contingency table of the species measured in each year using counts. Use the <code>species</code> variable first, followed by the new factor variable <code>year_fct</code>. (Think about why that order makes sense. <strong>We will always list the response variable first so that the categories of interest will be the rows and the groups will be the columns.</strong>)</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to make a contingency table for species and year with counts.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="exercise-10b" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-10b">Exercise 10(b)</h5>
<p>Make a contingency table of the species measured in each year using column percentages (<em>not</em> proportions). (Again, be sure to use the new factor variable <code>year_fct</code>, not the old variable <code>year</code>.)</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to make a contingency table for species and year with percentages.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="exercise-10c" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-10c">Exercise 10(c)</h5>
<p>How similar or dissimilar are the distributions of species across the three years of the study?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</section>
</section>
<section id="plotting-summary-data" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="plotting-summary-data"><span class="header-section-number">3.9</span> Plotting summary data</h2>
<p>Everything we did above was summarizing <em>raw data</em>; that is, the data consisted of all the observations for each individual penguin. Often, though, when you find data out in the wild, that data will be summarized into a table already and you may not have access to the raw data.</p>
<p>For example, let’s suppose that you found some data online, but it looked like this:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>species</th>
<th>count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Adelie</td>
<td>152</td>
</tr>
<tr class="even">
<td>Chinstrap</td>
<td>68</td>
</tr>
<tr class="odd">
<td>Gentoo</td>
<td>124</td>
</tr>
</tbody>
</table>
<p>This raises two questions:</p>
<ol type="1">
<li>How would you get this data into R?</li>
<li>How would you plot the data?</li>
</ol>
<p>To answer the first question, we show you how to create your own tibble. Here is the syntax:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>penguin_species_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">species =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span>, <span class="st">"Gentoo"</span>),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">count =</span> <span class="fu">c</span>(<span class="dv">152</span>, <span class="dv">68</span>, <span class="dv">124</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>penguin_species_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["species"],"name":[1],"type":["chr"],"align":["left"]},{"label":["count"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Adelie","2":"152"},{"1":"Chinstrap","2":"68"},{"1":"Gentoo","2":"124"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Basically, the <code>tibble</code> command creates a new tibble. Then each column of data must be entered manually as a “vector” using the <code>c</code> to group all the data values together for each column. Be careful about the placement of quotation marks, commas, and parentheses.</p>
<p>Once we have our summary data, we want to make a bar chart. But this won’t work:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguin_species_table, <span class="fu">aes</span>(<span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="exercise-12" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-12">Exercise 12</h5>
<p>Explain what went wrong with the previous command? Why does <code>ggplot</code> think that each species has count 1? (Hint: in tibble you just created, look at the <code>species</code> column. What if R thinks this is raw data where each row represents a single penguin?)</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>Instead, we need to use <code>geom_col</code>. This works a lot like <code>geom_bar</code> except that it also requires a <code>y</code> value in its aesthetics to force the command to look for the counts in some other variable in the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguin_species_table, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise-13a" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-13a">Exercise 13(a)</h5>
<p>Use the <code>tabyl</code> command to create a frequency table for <code>island</code>.</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to create a frequency table for island</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="exercise-13b" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-13b">Exercise 13(b)</h5>
<p>Use the <code>tibble</code> command to create a new tibble manually that contains the frequency data for the <code>island</code> variable. It should have two columns, one called <code>island</code> and the other called <code>count</code>. Name it <code>penguin_island_table</code>.</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to create a tibble with frequency data for island</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="exercise-13c" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-13c">Exercise 13(c)</h5>
<p>Use <code>ggplot</code> with <code>geom_col</code> to create a bar chart for island.</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add code here to create a bar chart for island</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
</section>
<section id="recovering-raw-data-from-tables" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="recovering-raw-data-from-tables"><span class="header-section-number">3.10</span> Recovering raw data from tables</h2>
<section id="recovering-raw-data-from-a-frequency-table" class="level3" data-number="3.10.1">
<h3 data-number="3.10.1" class="anchored" data-anchor-id="recovering-raw-data-from-a-frequency-table"><span class="header-section-number">3.10.1</span> Recovering raw data from a frequency table</h3>
<p>Sometimes we come across summary data instead of raw data. We’ve learned how to manually create tibbles with that summary data and use <code>geom_col</code> instead of <code>geom_bar</code> to graph it, but sometimes it is also useful to recover what the raw data <em>would</em> have been. Fortunately there are R tools to do exactly that.</p>
<p>We’ll continue with our example <code>penguin_species_table</code>, reprinted here for reference:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>penguin_species_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["species"],"name":[1],"type":["chr"],"align":["left"]},{"label":["count"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Adelie","2":"152"},{"1":"Chinstrap","2":"68"},{"1":"Gentoo","2":"124"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>From this table, we know what the raw data for this variable should look like: there should be 152 rows that say “Adelie,” 68 rows that say “Chinstrap,” and 124 rows that say “Gentoo.” It would be very annoying, though, to make that whole tibble by hand.</p>
<p>The hero of the day is the function <code>uncount</code> from the <code>tidyr</code> package (loaded automatically when you loaded the <code>tidyverse</code> package):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>penguin_species_raw <span class="ot">&lt;-</span> penguin_species_table <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uncount</span>(count)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>penguin_species_raw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["species"],"name":[1],"type":["chr"],"align":["left"]}],"data":[{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Adelie"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Chinstrap"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"},{"1":"Gentoo"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Click through the rows of this table and you’ll see that it’s exactly what we wanted: “Adelie” is repeated 152 times, “Chinstrap” is repeated 68 times, and “Gentoo” is repeated 124 times. Neat!</p>
</section>
<section id="recovering-raw-data-from-a-contingency-table" class="level3" data-number="3.10.2">
<h3 data-number="3.10.2" class="anchored" data-anchor-id="recovering-raw-data-from-a-contingency-table"><span class="header-section-number">3.10.2</span> Recovering raw data from a contingency table</h3>
<p>This strategy also works, with some modifications, for recovering the raw data presented in a contingency table. Previously, we saw the following contingency table showing the counts of each species broken down by sex:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>sex</th>
<th>Adelie</th>
<th>Chinstrap</th>
<th>Gentoo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>female</td>
<td>73</td>
<td>34</td>
<td>58</td>
</tr>
<tr class="even">
<td>male</td>
<td>73</td>
<td>34</td>
<td>61</td>
</tr>
</tbody>
</table>
<p>(Note: we’ve removed the unruly penguins who did not allow their sex to be determined.)</p>
<p>Again, we can imagine what the raw data would look like: there would be 73 rows where the <code>species</code> variable would say “Adelie” and the <code>sex</code> variable would say “female,” then 34 rows where the <code>species</code> variable would say “Chinstrap” and the <code>sex</code> variable would say “female,” and so on.</p>
<p>We can start by building a tibble with this information in the same way we built the tibble of penguin species counts. Note that the species labels now become the column headers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>penguin_species_sex_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>),</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Adelie =</span> <span class="fu">c</span>(<span class="dv">73</span>, <span class="dv">73</span>),</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Chinstrap =</span> <span class="fu">c</span>(<span class="dv">34</span>, <span class="dv">34</span>),</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gentoo =</span> <span class="fu">c</span>(<span class="dv">58</span>, <span class="dv">61</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>penguin_species_sex_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sex"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Adelie"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Chinstrap"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Gentoo"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"73","3":"34","4":"58"},{"1":"male","2":"73","3":"34","4":"61"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>In order for the <code>uncount</code> function to work correctly, we need to have all the counts in a single column, but since this is a contingency table, our counts are spread out across several columns. To solve this problem, we’ll need to “pivot” the columns, turning them into rows. The command is called <code>pivot_longer</code>. (There is also a <code>pivot_wider</code> command that turns rows into columns, but we won’t need that one.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>penguin_species_sex_table <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span>, <span class="st">"Gentoo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sex"],"name":[1],"type":["chr"],"align":["left"]},{"label":["name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["value"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"Adelie","3":"73"},{"1":"female","2":"Chinstrap","3":"34"},{"1":"female","2":"Gentoo","3":"58"},{"1":"male","2":"Adelie","3":"73"},{"1":"male","2":"Chinstrap","3":"34"},{"1":"male","2":"Gentoo","3":"61"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>If we want a little more control over the names of the newly created columns, we can add those as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>penguin_species_sex_table <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span>, <span class="st">"Gentoo"</span>),</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"species"</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sex"],"name":[1],"type":["chr"],"align":["left"]},{"label":["species"],"name":[2],"type":["chr"],"align":["left"]},{"label":["count"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"Adelie","3":"73"},{"1":"female","2":"Chinstrap","3":"34"},{"1":"female","2":"Gentoo","3":"58"},{"1":"male","2":"Adelie","3":"73"},{"1":"male","2":"Chinstrap","3":"34"},{"1":"male","2":"Gentoo","3":"61"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now our data is in a form that <code>uncount</code> can handle. And indeed, we can assemble all these steps together into a pipeline. First, we should build the tibble, then <code>pivot</code> the tibble, and finally <code>uncount</code> to get back to the raw data. We want store the result as a new tibble.</p>
<p>Here are all the steps put together:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the summary data in contingency table form,</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># stored as a tibble</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>penguin_species_sex_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">c</span>(<span class="st">"female"</span>, <span class="st">"male"</span>),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Adelie =</span> <span class="fu">c</span>(<span class="dv">73</span>, <span class="dv">73</span>),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Chinstrap =</span> <span class="fu">c</span>(<span class="dv">34</span>, <span class="dv">34</span>),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gentoo =</span> <span class="fu">c</span>(<span class="dv">58</span>, <span class="dv">61</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the pipeline that starts with the contingency table</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># and produces the raw data, one penguin per row</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>penguin_species_sex_table <span class="sc">|&gt;</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span>, <span class="st">"Gentoo"</span>),</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"species"</span>,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"count"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uncount</span>(count) <span class="ot">-&gt;</span> penguin_species_sex_raw</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>penguin_species_sex_raw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["sex"],"name":[1],"type":["chr"],"align":["left"]},{"label":["species"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Adelie"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Chinstrap"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"female","2":"Gentoo"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Adelie"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Chinstrap"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"},{"1":"male","2":"Gentoo"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Indeed, this new tibble looks just like how we wanted it to look.</p>
<p>(Notice the clever use of the arrow <code>-&gt;</code> in the last line of the pipeline. We are used to assigning variables with <code>&lt;-</code> and the name of the new variable on the left. But we can also use `-&gt; at the end of the line with the name of the new variable on the right!)</p>
</section>
</section>
<section id="publication-ready-graphics" class="level2" data-number="3.11">
<h2 data-number="3.11" class="anchored" data-anchor-id="publication-ready-graphics"><span class="header-section-number">3.11</span> Publication-ready graphics</h2>
<p>Let’s go back to the first relative frequency bar chart from this chapter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> <span class="fu">after_stat</span>(prop), <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The variable name <code>species</code> is already informative, but the y-axis is labeled with “prop”. Also note that this graph could use a title. We can do all this with <code>labs</code> (for labels). Observe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> <span class="fu">after_stat</span>(prop), <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of species"</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion"</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="using-colorblind-friendly-palettes" class="level3" data-number="3.11.1">
<h3 data-number="3.11.1" class="anchored" data-anchor-id="using-colorblind-friendly-palettes"><span class="header-section-number">3.11.1</span> Using colorblind-friendly palettes</h3>
<p>The default color scheme used in <code>ggplot2</code> is not designed to be friendly to folks who experience various forms of colorblindness (including the author of this book, who experiences deuteranomaly, a relatively common form of red-green colorblindness).</p>
<p>As a reminder, this was our side-by-side bar chart, now including labels:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">fill =</span> sex, <span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sex of penguins by species"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Species"</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A simple fix is to add one line of code to the <code>ggplot</code> call:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">fill =</span> sex, <span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sex of penguins by species"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Species"</span>,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sex"</span>) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To a person with typical color perception, this may feel a little like it’s burning your eyeballs. But to a person with severe colorblindness, this contrast is very helpful for seeing these two categories clearly.</p>
<p>Notice that the NA values above blend in with the background, so they’re not visible. This is fixed by putting black borders around the bars:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">fill =</span> sex, <span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sex of penguins by species"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Species"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sex"</span>) <span class="sc">+</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It’s also possible to use grayscale. This is often a requirement for publishing in print journals. If we use gray (spelled “grey” in <code>ggplot</code> code) for the bars, it would also be best to turn off the gray background using a “theme” (called <code>theme_bw</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">fill =</span> sex, <span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sex of penguins by species"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Species"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sex"</span>) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>() <span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For some reason, the default color for missing values is red, which is somewhat annoying. It doesn’t require much more code to change that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">fill =</span> sex, <span class="at">x =</span> species)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sex of penguins by species"</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Species"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Sex"</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>(<span class="at">na.value =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Learn more about the various forms of colorblindness here: <a href="https://my.clevelandclinic.org/health/diseases/11604-color-blindness">https://my.clevelandclinic.org/health/diseases/11604-color-blindness</a></p>
<p>And here’s a surprisingly entertaining (albeit, a bit technical in parts) video of a conference presentation given by the researchers who developed the Viridis color palette: <a href="https://youtu.be/xAoljeRJ3lU?si=ARxA7ZFkj_2qp6kL">https://youtu.be/xAoljeRJ3lU?si=ARxA7ZFkj_2qp6kL</a></p>
<section id="exercise-11" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="exercise-11">Exercise 11</h5>
<p>Modify the following side-by-side bar chart by adding a title and labels for both the fill variable and the x-axis variable. Change the y-axis label to “Count” with an uppercase “C”. Use the Viridis color palette with black borders around the bars.</p>
<div class="answer">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify the following side-by-side bar chart by adding a title and </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># labels for both the fill variable and the x-axis variable.</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the y-axis label to "Count" with an uppercase "C".</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the Viridis color palette with black borders around the bars.</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">fill =</span> species, <span class="at">x =</span> island)) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="03-categorical_data-web_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level2" data-number="3.12">
<h2 data-number="3.12" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">3.12</span> Conclusion</h2>
<p>You can summarize a single categorical variable using a frequency table. For only one categorical variable, a graph is usually overkill, but if you really want a graph, the bar chart is the best option. Both raw counts and proportions/percentages can be useful.</p>
<p>We use contingency tables to summarize two categorical variables. Unless groups are of equal size, raw counts can be incredibly misleading here. You should include proportions/percentages to be able to compare the distributions across groups. If the proportions/percentages are roughly the same, the variables are more likely to be independent, whereas if the proportions/percentages are different, there may be an association between the variables.</p>
<p>For graphing two categorical variables, the best choice is usually a side-by-side bar chart. A stacked bar chart will also work, especially if using relative frequencies on the y-axis, but it can be hard to compare across groups when the response variable has three or more categories.</p>
<p>Sometimes we come across categorical data that is recorded using numbers. Many R commands will not work properly if they expect factors and receive numbers, so we use the <code>mutate</code> command to create a new variable along with <code>as_factor</code> to convert the numbers to categories.</p>
<p>Sometimes we come across summary data instead of raw data. We can then manually create tibbles with that summary data and use <code>geom_col</code> instead of <code>geom_bar</code> to graph it. We can even reproduce the raw data by using the <code>uncount</code> command on tables.</p>
<p>Finally, there are various modifications we can make to <code>ggplot</code> code to make our graphs more professional, clear, and friendly for those experiencing colorblindness.</p>
<section id="preparing-and-submitting-your-assignment" class="level3" data-number="3.12.1">
<h3 data-number="3.12.1" class="anchored" data-anchor-id="preparing-and-submitting-your-assignment"><span class="header-section-number">3.12.1</span> Preparing and submitting your assignment</h3>
<ol type="1">
<li>From the “Run” menu, select “Restart R and Run All Chunks”.</li>
<li>Deal with any code errors that crop up. Repeat steps 1–2 until there are no more code errors.</li>
<li>Spell check your document by clicking the icon with “ABC” and a check mark.</li>
<li>Hit the “Render” button one last time to generate the final draft of the HTML file. (If there are errors here, you may need to go back and fix broken inline code or other markdown issues.)</li>
<li>Proofread the HTML file carefully. If there are errors, go back and fix them, then repeat steps 1–5 again.</li>
</ol>
<p>If you have completed this chapter as part of a statistics course, follow the directions you receive from your professor to submit your assignment.</p>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Why the “2”? It’s a long story. Google it if you’re interested in the history of the development of the <code>ggplot2</code> package.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-using_quarto-web.html" class="pagination-link" aria-label="Using Quarto">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Using Quarto</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-numerical_data-web.html" class="pagination-link" aria-label="Numerical data">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Numerical data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/VectorPosse/intro_stats/edit/main/03-categorical_data-web.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/VectorPosse/intro_stats/issues" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>